(library
 (name ocannl)
 (libraries
  base
  core
  printbox
  printbox-text
  npy
  stdio
  domainslib
  dynlink
  str
  ; mem_usage
  gccjit
  cudajit)
 (preprocess
  (pps ppx_jane ppx_ocannl ppx_minidebug))
 (modules
  PrintBox_utils
  node
  nodeUI
  shape
  code
  formula
  operation
  session
  exec_as_gccjit
  exec_as_cuda)
 (modes byte native)
 (c_library_flags -pthread))

(library
 (name ppx_ocannl)
 (kind ppx_rewriter)
 (modules ppx_nn_shared ppx_nn_cd ppx_nn_op ppx_ocannl)
 (libraries base ppxlib str)
 (preprocess
  (pps ppx_jane ppxlib.metaquot)))
