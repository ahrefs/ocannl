FIXME: soon we will update the CUDA backend wholesale to catch up with recent work