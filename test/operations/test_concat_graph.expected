Retrieving commandline, environment, or config file variable ocannl_log_level
Found 0, in the config file
=== Concatenation Forward and Backprop Graph Test ===

--- Input tensors ---
x1 = [1.0, 2.0, 3.0] (dim 3)
x2 = [4.0, 5.0] (dim 2)

--- Forward pass: sin((x1, x2) ++^ "a; b => a^b") ---
Concatenated result (after sin):
HERE: test/operations/test_concat_graph.ml:42:21
┌──────────────────────────────────────────────────┐
│[6]: sin_result shape 0:5                         │
│┌┬───────────────────────────────────────────────┐│
│││axis 0                                         ││
│├┼───────────────────────────────────────────────┤│
│││ 8.41e-1  9.09e-1  1.41e-1  -7.56e-1  -9.58e-1 ││
│└┴───────────────────────────────────────────────┘│
└──────────────────────────────────────────────────┘

--- Backward pass: gradients ---
Loss (sum of all sin values):
HERE: test/operations/test_concat_graph.ml:46:21
┌───────────────────────┐
│[9]: =>_loss shape 0:1 │
│┌┬─────────┐           │
│││axis 0   │           │
│├┼─────────┤           │
│││ 1.76e-1 │           │
│└┴─────────┘           │
└───────────────────────┘

Gradient of x1 (cos of original values):
HERE: test/operations/test_concat_graph.ml:49:21
┌─────────────────────┐
│[0]: 1,2,3 shape 0:3 │
│┌┬──────────────────┐│
│││axis 0            ││
│├┼──────────────────┤│
│││ 1.00  2.00  3.00 ││
│└┴──────────────────┘│
└─────────────────────┘
┌────────────────────────────────┐
│[0]: 1,2,3 shape 0:3  grad_1,2,3│
│┌┬─────────────────────────────┐│
│││axis 0                       ││
│├┼─────────────────────────────┤│
│││ 5.40e-1  -4.16e-1  -9.89e-1 ││
│└┴─────────────────────────────┘│
└────────────────────────────────┘

Gradient of x2:
HERE: test/operations/test_concat_graph.ml:52:21
┌───────────────────┐
│[2]: 4,5 shape 0:2 │
│┌┬────────────┐    │
│││axis 0      │    │
│├┼────────────┤    │
│││ 4.00  5.00 │    │
│└┴────────────┘    │
└───────────────────┘
┌────────────────────────────┐
│[2]: 4,5 shape 0:2  grad_4,5│
│┌┬───────────────────┐      │
│││axis 0             │      │
│├┼───────────────────┤      │
│││ -6.53e-1  2.83e-1 │      │
│└┴───────────────────┘      │
└────────────────────────────┘

=== Three-way Concatenation Forward and Backprop Graph Test ===

--- Input tensors ---
x1_3 = [1.0, 2.0] (dim 2)
x2_3 = [3.0, 4.0, 5.0] (dim 3)
x3_3 = [6.0, 7.0] (dim 2)

--- Forward pass: sin((x1_3, x2_3, x3_3) ++^ "a; b; c => a^b^c") ---
Concatenated result (after sin):
HERE: test/operations/test_concat_graph.ml:88:21
┌─────────────────────────────────────────────┐
│[20]: sin_result3 shape 0:7                  │
│┌┬──────────────────────────────────────────┐│
│││axis 0                                    ││
│├┼──────────────────────────────────────────┤│
│││ 8.41e-1  9.09e-1  ...  -2.79e-1  6.56e-1 ││
│└┴──────────────────────────────────────────┘│
└─────────────────────────────────────────────┘

--- Backward pass: gradients ---
Loss (sum of all sin values):
HERE: test/operations/test_concat_graph.ml:92:21
┌─────────────────────────┐
│[23]: =>_loss3 shape 0:1 │
│┌┬─────────┐             │
│││axis 0   │             │
│├┼─────────┤             │
│││ 5.53e-1 │             │
│└┴─────────┘             │
└─────────────────────────┘

Gradient of x1_3 (cos of original values):
HERE: test/operations/test_concat_graph.ml:95:21
┌────────────────────┐
│[12]: 1,2 shape 0:2 │
│┌┬────────────┐     │
│││axis 0      │     │
│├┼────────────┤     │
│││ 1.00  2.00 │     │
│└┴────────────┘     │
└────────────────────┘
┌─────────────────────────────┐
│[12]: 1,2 shape 0:2  grad_1,2│
│┌┬───────────────────┐       │
│││axis 0             │       │
│├┼───────────────────┤       │
│││ 5.40e-1  -4.16e-1 │       │
│└┴───────────────────┘       │
└─────────────────────────────┘

Gradient of x2_3:
HERE: test/operations/test_concat_graph.ml:98:21
┌──────────────────────┐
│[14]: 3,4,5 shape 0:3 │
│┌┬──────────────────┐ │
│││axis 0            │ │
│├┼──────────────────┤ │
│││ 3.00  4.00  5.00 │ │
│└┴──────────────────┘ │
└──────────────────────┘
┌─────────────────────────────────┐
│[14]: 3,4,5 shape 0:3  grad_3,4,5│
│┌┬─────────────────────────────┐ │
│││axis 0                       │ │
│├┼─────────────────────────────┤ │
│││ -9.89e-1  -6.53e-1  2.83e-1 │ │
│└┴─────────────────────────────┘ │
└─────────────────────────────────┘

Gradient of x3_3:
HERE: test/operations/test_concat_graph.ml:101:21
┌────────────────────┐
│[16]: 6,7 shape 0:2 │
│┌┬────────────┐     │
│││axis 0      │     │
│├┼────────────┤     │
│││ 6.00  7.00 │     │
│└┴────────────┘     │
└────────────────────┘
┌─────────────────────────────┐
│[16]: 6,7 shape 0:2  grad_6,7│
│┌┬──────────────────┐        │
│││axis 0            │        │
│├┼──────────────────┤        │
│││ 9.60e-1  7.53e-1 │        │
│└┴──────────────────┘        │
└─────────────────────────────┘

=== Three-way Concat With Unit Dimension Test ===

--- Input tensors ---
x1_u = [1.0, 2.0] (dim 2)
x2_u = [3.0] (dim 1)
x3_u = [4.0, 5.0] (dim 2)

--- Forward pass: sin((x1_u, x2_u, x3_u) ++^ "a; b; c => a^b^c") ---
Concatenated result (after sin):
HERE: test/operations/test_concat_graph.ml:138:23
┌──────────────────────────────────────────────────┐
│[34]: sin_result_u shape 0:5                      │
│┌┬───────────────────────────────────────────────┐│
│││axis 0                                         ││
│├┼───────────────────────────────────────────────┤│
│││ 8.41e-1  9.09e-1  1.41e-1  -7.56e-1  -9.58e-1 ││
│└┴───────────────────────────────────────────────┘│
└──────────────────────────────────────────────────┘

--- Backward pass: gradients ---
Loss (sum of all sin values):
HERE: test/operations/test_concat_graph.ml:142:23
┌──────────────────────────┐
│[37]: =>_loss_u shape 0:1 │
│┌┬─────────┐              │
│││axis 0   │              │
│├┼─────────┤              │
│││ 1.76e-1 │              │
│└┴─────────┘              │
└──────────────────────────┘

Gradient of x1_u (cos of original values):
HERE: test/operations/test_concat_graph.ml:145:23
┌────────────────────┐
│[26]: 1,2 shape 0:2 │
│┌┬────────────┐     │
│││axis 0      │     │
│├┼────────────┤     │
│││ 1.00  2.00 │     │
│└┴────────────┘     │
└────────────────────┘
┌─────────────────────────────┐
│[26]: 1,2 shape 0:2  grad_1,2│
│┌┬───────────────────┐       │
│││axis 0             │       │
│├┼───────────────────┤       │
│││ 5.40e-1  -4.16e-1 │       │
│└┴───────────────────┘       │
└─────────────────────────────┘

Gradient of x2_u:
HERE: test/operations/test_concat_graph.ml:148:23
[28]: 3 shape 0:1  <not-hosted>
┌─────────────────────────┐
│[28]: 3 shape 0:1  grad_3│
│┌┬──────────┐            │
│││axis 0    │            │
│├┼──────────┤            │
│││ -9.89e-1 │            │
│└┴──────────┘            │
└─────────────────────────┘

Gradient of x3_u:
HERE: test/operations/test_concat_graph.ml:151:23
┌────────────────────┐
│[30]: 4,5 shape 0:2 │
│┌┬────────────┐     │
│││axis 0      │     │
│├┼────────────┤     │
│││ 4.00  5.00 │     │
│└┴────────────┘     │
└────────────────────┘
┌─────────────────────────────┐
│[30]: 4,5 shape 0:2  grad_4,5│
│┌┬───────────────────┐       │
│││axis 0             │       │
│├┼───────────────────┤       │
│││ -6.53e-1  2.83e-1 │       │
│└┴───────────────────┘       │
└─────────────────────────────┘

=== Concatenation Graph Test Complete ===

=== Three-way Concatenation Test (Known Limitation) ===

ERROR: ("Utils.User_error(\"Ambiguous indices in concatenation: multiple blocks viable for same position\")")

=== Three-way Concatenation Test Complete ===
