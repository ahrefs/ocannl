#include <cuda_fp16.h>
#include <cuda_bf16.h>

/* Define math constants that would normally come from <math.h> */
#ifndef INFINITY
#define INFINITY __int_as_float(0x7f800000)
#endif
#ifndef NAN
#define NAN __int_as_float(0x7fffffff)
#endif
extern "C" __global__ void d_fwd(
    __half *a,
    __half *b,
    __nv_bfloat16 *c,
    __nv_bfloat16 *d) {
  /* FIXME: single-threaded for now. */if (threadIdx.x != 0 || blockIdx.x != 0) { return; };

  /* Local declarations and initialization. */

  /* Main logic. */
  /* d fwd */
  d[0] = (((__nv_bfloat16)(a[0]) + (__nv_bfloat16)(b[0])) * c[0]);
  /* end */
}