Retrieving commandline, environment, or config file variable ocannl_log_level
Found 0, in the config file
Testing max_pool2d with default parameters (stride=2, window=2)...
Input shape: 4x4x1
Window size: 2x2
Stride: 2
Expected output spatial dims: 2x2
HERE: test/einsum/test_max_pool2d.ml:31:21
┌──────────────────────────────┐
│[0]: r4x4x1 shape 0:4,1:4,2:1 │
│┌──────┬─────────┐            │
││      │axis 2   │            │
│├──────┼─────────┤            │
││0 @ 0 │ 0.00    │            │
││axis 1│ 1.00    │            │
││      │ 2.00    │            │
││      │ 3.00    │            │
│├──────┼─────────┤            │
││1 @ 0 │ 4.00    │            │
││axis 1│ 5.00    │            │
││      │ 6.00    │            │
││      │ 7.00    │            │
│├──────┼─────────┤            │
││2 @ 0 │ 8.00    │            │
││axis 1│ 9.00    │            │
││      │ 1.00e+1 │            │
││      │ 1.10e+1 │            │
│├──────┼─────────┤            │
││3 @ 0 │ 1.20e+1 │            │
││axis 1│ 1.30e+1 │            │
││      │ 1.40e+1 │            │
││      │ 1.50e+1 │            │
│└──────┴─────────┘            │
└──────────────────────────────┘
HERE: test/einsum/test_max_pool2d.ml:32:21
┌────────────────────────────────────────┐
│[4]: @^=>+_max_pool2d shape 0:2,1:2,2:1 │
│┌──────┬─────────┐                      │
││      │axis 2   │                      │
│├──────┼─────────┤                      │
││0 @ 0 │ 6.00    │                      │
││axis 1│ 8.00    │                      │
│├──────┼─────────┤                      │
││1 @ 0 │ 1.40e+1 │                      │
││axis 1│ 1.60e+1 │                      │
│└──────┴─────────┘                      │
└────────────────────────────────────────┘

Testing max_pool2d with stride=2, window=3...
Input shape: 7x7x2
Window size: 3x3
Stride: 2
HERE: test/einsum/test_max_pool2d.ml:58:21
┌──────────────────────────────┐
│[0]: r7x7x2 shape 0:7,1:7,2:2 │
│┌──────┬──────────────────┐   │
││      │axis 2            │   │
│├──────┼──────────────────┤   │
││0 @ 0 │ 0.00     1.00    │   │
││axis 1│ 2.00     3.00    │   │
││      │ ...      ...     │   │
││      │ 1.00e+1  1.10e+1 │   │
││      │ 1.20e+1  1.30e+1 │   │
│├──────┼──────────────────┤   │
││1 @ 0 │ 1.40e+1  1.50e+1 │   │
││axis 1│ 1.60e+1  1.70e+1 │   │
││      │ ...      ...     │   │
││      │ 2.40e+1  2.50e+1 │   │
││      │ 2.60e+1  2.70e+1 │   │
│├──────┼──────────────────┤   │
││~~~~~ │ ...              │   │
││axis 1│                  │   │
│├──────┼──────────────────┤   │
││5 @ 0 │ 7.00e+1  7.10e+1 │   │
││axis 1│ 7.20e+1  7.30e+1 │   │
││      │ ...      ...     │   │
││      │ 8.00e+1  8.10e+1 │   │
││      │ 8.20e+1  8.30e+1 │   │
│├──────┼──────────────────┤   │
││6 @ 0 │ 8.40e+1  8.50e+1 │   │
││axis 1│ 8.60e+1  8.70e+1 │   │
││      │ ...      ...     │   │
││      │ 9.40e+1  9.50e+1 │   │
││      │ 9.60e+1  9.70e+1 │   │
│└──────┴──────────────────┘   │
└──────────────────────────────┘
HERE: test/einsum/test_max_pool2d.ml:59:21
┌────────────────────────────────────────┐
│[4]: @^=>+_max_pool2d shape 0:3,1:3,2:2 │
│┌──────┬──────────────────┐             │
││      │axis 2            │             │
│├──────┼──────────────────┤             │
││0 @ 0 │ 3.30e+1  3.40e+1 │             │
││axis 1│ 3.70e+1  3.80e+1 │             │
││      │ 4.10e+1  4.20e+1 │             │
│├──────┼──────────────────┤             │
││1 @ 0 │ 6.10e+1  6.20e+1 │             │
││axis 1│ 6.50e+1  6.60e+1 │             │
││      │ 6.90e+1  7.00e+1 │             │
│├──────┼──────────────────┤             │
││2 @ 0 │ 8.90e+1  9.00e+1 │             │
││axis 1│ 9.30e+1  9.40e+1 │             │
││      │ 9.70e+1  9.80e+1 │             │
│└──────┴──────────────────┘             │
└────────────────────────────────────────┘

Testing max_pool2d with output dimension 1...
Input shape: 3x3x1
Window size: 3x3
Stride: 2
Expected output spatial dims: 1x1
HERE: test/einsum/test_max_pool2d.ml:86:21
┌──────────────────────────────┐
│[0]: r3x3x1 shape 0:3,1:3,2:1 │
│┌──────┬──────┐               │
││      │axis 2│               │
│├──────┼──────┤               │
││0 @ 0 │ 0.00 │               │
││axis 1│ 1.00 │               │
││      │ 2.00 │               │
│├──────┼──────┤               │
││1 @ 0 │ 3.00 │               │
││axis 1│ 4.00 │               │
││      │ 5.00 │               │
│├──────┼──────┤               │
││2 @ 0 │ 6.00 │               │
││axis 1│ 7.00 │               │
││      │ 8.00 │               │
│└──────┴──────┘               │
└──────────────────────────────┘
HERE: test/einsum/test_max_pool2d.ml:87:21
┌────────────────────────────────────────┐
│[4]: @^=>+_max_pool2d shape 0:1,1:1,2:1 │
│┌──────┬──────┐                         │
││      │axis 2│                         │
│├──────┼──────┤                         │
││0 @ 0 │ 9.00 │                         │
││axis 1│      │                         │
│└──────┴──────┘                         │
└────────────────────────────────────────┘

Testing max_pool2d preserves channel dimension...
Input shape: 4x4x3
Expected output shape: 2x2x3 (channels preserved)
HERE: test/einsum/test_max_pool2d.ml:109:21
┌────────────────────────────────────────┐
│[4]: @^=>+_max_pool2d shape 0:2,1:2,2:3 │
│┌──────┬───────────────────────────┐    │
││      │axis 2                     │    │
│├──────┼───────────────────────────┤    │
││0 @ 0 │ 1.60e+1  1.70e+1  1.80e+1 │    │
││axis 1│ 2.20e+1  2.30e+1  2.40e+1 │    │
│├──────┼───────────────────────────┤    │
││1 @ 0 │ 4.00e+1  4.10e+1  4.20e+1 │    │
││axis 1│ 4.60e+1  4.70e+1  4.80e+1 │    │
│└──────┴───────────────────────────┘    │
└────────────────────────────────────────┘

All max_pool2d tests completed!
