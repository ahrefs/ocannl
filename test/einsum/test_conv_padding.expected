Retrieving commandline, environment, or config file variable ocannl_log_level
Found 0, in the config file
Testing conv2d with use_padding=true preserves dimensions...
Input shape: 5x5x1
Kernel size: 3x3
Stride: 1
use_padding: true
out_channels: 4
Expected output spatial dims: 5x5 (same as input)
HERE: test/einsum/test_conv_padding.ml:35:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:5,1:5,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 6.30     2.80     4.30     4.80    ││
││axis 1│ 1.36e+1  9.03     7.90     7.28    ││
││      │ 1.74e+1  1.25e+1  1.11e+1  1.03e+1 ││
││      │ 2.12e+1  1.60e+1  1.44e+1  1.33e+1 ││
││      │ 1.96e+1  1.36e+1  8.60     1.16e+1 ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 1.89e+1  1.28e+1  1.72e+1  1.50e+1 ││
││axis 1│ 3.36e+1  2.78e+1  2.61e+1  2.43e+1 ││
││      │ 3.82e+1  3.23e+1  3.09e+1  2.90e+1 ││
││      │ 4.28e+1  3.68e+1  3.58e+1  3.38e+1 ││
││      │ 3.54e+1  2.80e+1  2.11e+1  2.77e+1 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 3.40e+1  2.67e+1  3.48e+1  3.14e+1 ││
││axis 1│ 5.66e+1  5.02e+1  5.03e+1  4.80e+1 ││
││      │ 6.12e+1  5.47e+1  5.52e+1  5.27e+1 ││
││      │ 6.58e+1  5.92e+1  6.00e+1  5.74e+1 ││
││      │ 5.18e+1  4.31e+1  3.50e+1  4.54e+1 ││
│├──────┼────────────────────────────────────┤│
││3 @ 0 │ 4.92e+1  4.06e+1  5.24e+1  4.78e+1 ││
││axis 1│ 7.96e+1  7.26e+1  7.46e+1  7.16e+1 ││
││      │ 8.42e+1  7.71e+1  7.95e+1  7.63e+1 ││
││      │ 8.88e+1  8.16e+1  8.43e+1  8.11e+1 ││
││      │ 6.81e+1  5.83e+1  4.89e+1  6.30e+1 ││
│├──────┼────────────────────────────────────┤│
││4 @ 0 │ 3.68e+1  4.58e+1  5.48e+1  4.28e+1 ││
││axis 1│ 4.94e+1  6.45e+1  7.71e+1  7.03e+1 ││
││      │ 5.19e+1  6.78e+1  8.12e+1  7.40e+1 ││
││      │ 5.44e+1  7.11e+1  8.52e+1  7.78e+1 ││
││      │ 3.21e+1  4.26e+1  5.31e+1  6.36e+1 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘

Testing conv2d with use_padding=false reduces dimensions...
Input shape: 5x5x1
Kernel size: 3x3
Stride: 1
use_padding: false
out_channels: 4
Expected output spatial dims: 3x3 (reduced by kernel_size-1)
HERE: test/einsum/test_conv_padding.ml:65:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:3,1:3,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 3.36e+1  2.78e+1  2.61e+1  2.43e+1 ││
││axis 1│ 3.82e+1  3.23e+1  3.09e+1  2.90e+1 ││
││      │ 4.28e+1  3.68e+1  3.58e+1  3.38e+1 ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 5.66e+1  5.02e+1  5.03e+1  4.80e+1 ││
││axis 1│ 6.12e+1  5.47e+1  5.52e+1  5.27e+1 ││
││      │ 6.58e+1  5.92e+1  6.00e+1  5.74e+1 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 7.96e+1  7.26e+1  7.46e+1  7.16e+1 ││
││axis 1│ 8.42e+1  7.71e+1  7.95e+1  7.63e+1 ││
││      │ 8.88e+1  8.16e+1  8.43e+1  8.11e+1 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘

Testing conv2d with stride=2 and use_padding=true...
Input shape: 6x6x1
Kernel size: 3x3
Stride: 2
use_padding: true
out_channels: 4
Expected output spatial dims: 3x3 (input/stride)
HERE: test/einsum/test_conv_padding.ml:95:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:3,1:3,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 7.39     3.14     4.89     5.64    ││
││axis 1│ 1.95e+1  1.37e+1  1.20e+1  1.12e+1 ││
││      │ 2.70e+1  2.08e+1  1.85e+1  1.73e+1 ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 4.06e+1  3.17e+1  4.14e+1  3.75e+1 ││
││axis 1│ 7.16e+1  6.39e+1  6.41e+1  6.14e+1 ││
││      │ 8.09e+1  7.29e+1  7.39e+1  7.09e+1 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 7.69e+1  6.51e+1  8.37e+1  7.68e+1 ││
││axis 1│ 1.26e+2  1.17e+2  1.22e+2  1.18e+2 ││
││      │ 1.36e+2  1.26e+2  1.32e+2  1.27e+2 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘

Input: single prec 6+3x6+3x1

Testing backprop for conv2d with stride=2 and use_padding=true...
Input shape: 6x6x1
Kernel size: 3x3
Stride: 2
use_padding: true
out_channels: 4
Backprop completed successfully!
HERE: test/einsum/test_conv_padding.ml:127:21
┌────────────────────────┐
│[14]: =>_loss shape 0:1 │
│┌┬─────────┐            │
│││axis 0   │            │
│├┼─────────┤            │
│││ 2.18e+3 │            │
│└┴─────────┘            │
└────────────────────────┘
grad_=>_loss <not-hosted>
Testing conv2d with stride=2 and use_padding=false...
Input shape: 9x9x1
Kernel size: 3x3
Stride: 2
use_padding: false
out_channels: 4
Expected output spatial dims: 4x4 ((9-3)/2 + 1)
HERE: test/einsum/test_conv_padding.ml:159:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:4,1:4,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 5.70e+1  4.67e+1  4.25e+1  4.02e+1 ││
││axis 1│ 6.62e+1  5.57e+1  5.22e+1  4.97e+1 ││
││      │ 7.54e+1  6.46e+1  6.19e+1  5.91e+1 ││
││      │ 8.46e+1  7.36e+1  7.16e+1  6.86e+1 ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 1.39e+2  1.27e+2  1.29e+2  1.25e+2 ││
││axis 1│ 1.49e+2  1.36e+2  1.39e+2  1.34e+2 ││
││      │ 1.58e+2  1.45e+2  1.49e+2  1.44e+2 ││
││      │ 1.67e+2  1.54e+2  1.59e+2  1.53e+2 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 2.22e+2  2.07e+2  2.17e+2  2.10e+2 ││
││axis 1│ 2.31e+2  2.16e+2  2.26e+2  2.19e+2 ││
││      │ 2.41e+2  2.25e+2  2.36e+2  2.29e+2 ││
││      │ 2.50e+2  2.34e+2  2.46e+2  2.38e+2 ││
│├──────┼────────────────────────────────────┤│
││3 @ 0 │ 3.05e+2  2.88e+2  3.04e+2  2.95e+2 ││
││axis 1│ 3.14e+2  2.97e+2  3.14e+2  3.05e+2 ││
││      │ 3.24e+2  3.06e+2  3.24e+2  3.14e+2 ││
││      │ 3.33e+2  3.15e+2  3.33e+2  3.23e+2 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘


Testing backprop for conv2d with stride=2 and use_padding=false...
Input shape: 9x9x1
Kernel size: 3x3
Stride: 2
use_padding: false
out_channels: 4
Expected output shape: 4x4 ((9-3)/2 + 1)
Backprop completed successfully!
HERE: test/einsum/test_conv_padding.ml:198:21
┌────────────────────────┐
│[14]: =>_loss shape 0:1 │
│┌┬─────────┐            │
│││axis 0   │            │
│├┼─────────┤            │
│││ 1.19e+4 │            │
│└┴─────────┘            │
└────────────────────────┘
grad_=>_loss <not-hosted>

All conv padding tests completed!
