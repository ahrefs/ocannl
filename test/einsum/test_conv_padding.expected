Retrieving commandline, environment, or config file variable ocannl_log_level
Found 0, in the config file
Testing conv2d with use_padding=true preserves dimensions...
Input shape: 5x5x1
Kernel size: 3x3
Stride: 1
use_padding: true
out_channels: 4
Expected output spatial dims: 5x5 (same as input)
HERE: test/einsum/test_conv_padding.ml:35:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:5,1:5,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 5.30     1.05e+1  4.57     4.77    ││
││axis 1│ 1.00e+1  1.71e+1  9.76     7.96    ││
││      │ 1.31e+1  2.16e+1  1.26e+1  1.03e+1 ││
││      │ 1.62e+1  2.61e+1  1.54e+1  1.26e+1 ││
││      │ 1.06e+1  1.76e+1  1.38e+1  8.60    ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 1.82e+1  2.73e+1  1.48e+1  1.30e+1 ││
││axis 1│ 2.62e+1  4.15e+1  2.53e+1  2.07e+1 ││
││      │ 2.98e+1  4.73e+1  3.02e+1  2.38e+1 ││
││      │ 3.34e+1  5.31e+1  3.51e+1  2.70e+1 ││
││      │ 2.06e+1  3.27e+1  3.05e+1  1.77e+1 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 3.28e+1  4.83e+1  3.06e+1  2.46e+1 ││
││axis 1│ 4.41e+1  7.06e+1  4.98e+1  3.64e+1 ││
││      │ 4.77e+1  7.64e+1  5.47e+1  3.95e+1 ││
││      │ 5.13e+1  8.23e+1  5.96e+1  4.26e+1 ││
││      │ 3.10e+1  4.85e+1  4.99e+1  2.73e+1 ││
│├──────┼────────────────────────────────────┤│
││3 @ 0 │ 4.74e+1  6.94e+1  4.64e+1  3.61e+1 ││
││axis 1│ 6.21e+1  9.98e+1  7.43e+1  5.21e+1 ││
││      │ 6.56e+1  1.05e+2  7.92e+1  5.52e+1 ││
││      │ 6.92e+1  1.11e+2  8.41e+1  5.83e+1 ││
││      │ 4.13e+1  6.43e+1  6.94e+1  3.70e+1 ││
│├──────┼────────────────────────────────────┤│
││4 @ 0 │ 4.16e+1  4.53e+1  4.29e+1  2.76e+1 ││
││axis 1│ 4.80e+1  6.46e+1  6.29e+1  3.90e+1 ││
││      │ 5.03e+1  6.80e+1  6.64e+1  4.10e+1 ││
││      │ 5.27e+1  7.13e+1  6.99e+1  4.31e+1 ││
││      │ 2.89e+1  3.55e+1  5.29e+1  2.72e+1 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘

Testing conv2d with use_padding=false reduces dimensions...
Input shape: 5x5x1
Kernel size: 3x3
Stride: 1
use_padding: false
out_channels: 4
Expected output spatial dims: 3x3 (reduced by kernel_size-1)
HERE: test/einsum/test_conv_padding.ml:65:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:3,1:3,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 2.62e+1  4.15e+1  2.53e+1  2.07e+1 ││
││axis 1│ 2.98e+1  4.73e+1  3.02e+1  2.38e+1 ││
││      │ 3.34e+1  5.31e+1  3.51e+1  2.70e+1 ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 4.41e+1  7.06e+1  4.98e+1  3.64e+1 ││
││axis 1│ 4.77e+1  7.64e+1  5.47e+1  3.95e+1 ││
││      │ 5.13e+1  8.23e+1  5.96e+1  4.26e+1 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 6.21e+1  9.98e+1  7.43e+1  5.21e+1 ││
││axis 1│ 6.56e+1  1.05e+2  7.92e+1  5.52e+1 ││
││      │ 6.92e+1  1.11e+2  8.41e+1  5.83e+1 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘

Testing conv2d with stride=2 and use_padding=true...
Input shape: 6x6x1
Kernel size: 3x3
Stride: 2
use_padding: true
out_channels: 4
Expected output spatial dims: 3x3 (input/stride)
HERE: test/einsum/test_conv_padding.ml:95:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:3,1:3,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 6.10     1.22e+1  5.33     5.55    ││
││axis 1│ 1.44e+1  2.41e+1  1.40e+1  1.14e+1 ││
││      │ 2.06e+1  3.30e+1  1.96e+1  1.60e+1 ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 3.91e+1  5.75e+1  3.66e+1  2.93e+1 ││
││axis 1│ 5.57e+1  8.92e+1  6.39e+1  4.61e+1 ││
││      │ 6.28e+1  1.00e+2  7.37e+1  5.24e+1 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 7.41e+1  1.08e+2  7.45e+1  5.69e+1 ││
││axis 1│ 9.87e+1  1.59e+2  1.22e+2  8.38e+1 ││
││      │ 1.05e+2  1.70e+2  1.32e+2  9.00e+1 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘

Input: single prec 6+3x6+3x1

Testing backprop for conv2d with stride=2 and use_padding=true...
Input shape: 6x6x1
Kernel size: 3x3
Stride: 2
use_padding: true
out_channels: 4
Backprop completed successfully!
HERE: test/einsum/test_conv_padding.ml:127:21
┌────────────────────────┐
│[14]: =>_loss shape 0:1 │
│┌┬─────────┐            │
│││axis 0   │            │
│├┼─────────┤            │
│││ 2.16e+3 │            │
│└┴─────────┘            │
└────────────────────────┘
grad_=>_loss <not-hosted>
Testing conv2d with stride=2 and use_padding=false...
Input shape: 9x9x1
Kernel size: 3x3
Stride: 2
use_padding: false
out_channels: 4
Expected output spatial dims: 4x4 ((9-3)/2 + 1)
HERE: test/einsum/test_conv_padding.ml:159:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:4,1:4,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 4.36e+1  6.92e+1  4.23e+1  3.44e+1 ││
││axis 1│ 5.08e+1  8.08e+1  5.21e+1  4.07e+1 ││
││      │ 5.80e+1  9.25e+1  6.19e+1  4.70e+1 ││
││      │ 6.52e+1  1.04e+2  7.17e+1  5.33e+1 ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 1.08e+2  1.74e+2  1.30e+2  9.09e+1 ││
││axis 1│ 1.15e+2  1.85e+2  1.40e+2  9.72e+1 ││
││      │ 1.22e+2  1.97e+2  1.50e+2  1.03e+2 ││
││      │ 1.29e+2  2.09e+2  1.59e+2  1.09e+2 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 1.72e+2  2.79e+2  2.18e+2  1.47e+2 ││
││axis 1│ 1.79e+2  2.90e+2  2.28e+2  1.53e+2 ││
││      │ 1.87e+2  3.02e+2  2.38e+2  1.60e+2 ││
││      │ 1.94e+2  3.14e+2  2.48e+2  1.66e+2 ││
│├──────┼────────────────────────────────────┤│
││3 @ 0 │ 2.37e+2  3.84e+2  3.07e+2  2.03e+2 ││
││axis 1│ 2.44e+2  3.95e+2  3.16e+2  2.10e+2 ││
││      │ 2.51e+2  4.07e+2  3.26e+2  2.16e+2 ││
││      │ 2.58e+2  4.19e+2  3.36e+2  2.22e+2 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘


Testing backprop for conv2d with stride=2 and use_padding=false...
Input shape: 9x9x1
Kernel size: 3x3
Stride: 2
use_padding: false
out_channels: 4
Expected output shape: 4x4 ((9-3)/2 + 1)
Backprop completed successfully!
HERE: test/einsum/test_conv_padding.ml:198:21
┌────────────────────────┐
│[14]: =>_loss shape 0:1 │
│┌┬─────────┐            │
│││axis 0   │            │
│├┼─────────┤            │
│││ 1.14e+4 │            │
│└┴─────────┘            │
└────────────────────────┘
grad_=>_loss <not-hosted>

All conv padding tests completed!
