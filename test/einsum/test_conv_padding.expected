Retrieving commandline, environment, or config file variable ocannl_log_level
Found 0, in the config file
Testing conv2d with use_padding=true preserves dimensions...
Input shape: 5x5x1
Kernel size: 3x3
Stride: 1
use_padding: true
out_channels: 4
Expected output spatial dims: 5x5 (same as input)
HERE: test/einsum/test_conv_padding.ml:35:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:5,1:5,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 4.23     3.41     5.10     6.57    ││
││axis 1│ 7.89     9.82     1.03e+1  1.23e+1 ││
││      │ 1.03e+1  1.34e+1  1.43e+1  1.55e+1 ││
││      │ 1.28e+1  1.70e+1  1.83e+1  1.87e+1 ││
││      │ 9.06     1.34e+1  1.48e+1  1.56e+1 ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 1.26e+1  1.44e+1  1.74e+1  1.59e+1 ││
││axis 1│ 2.18e+1  2.95e+1  3.04e+1  3.04e+1 ││
││      │ 2.57e+1  3.47e+1  3.47e+1  3.57e+1 ││
││      │ 2.97e+1  3.99e+1  3.90e+1  4.11e+1 ││
││      │ 2.06e+1  2.91e+1  3.02e+1  3.21e+1 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 2.56e+1  3.05e+1  2.98e+1  3.16e+1 ││
││axis 1│ 4.15e+1  5.55e+1  5.19e+1  5.71e+1 ││
││      │ 4.54e+1  6.07e+1  5.63e+1  6.24e+1 ││
││      │ 4.94e+1  6.59e+1  6.06e+1  6.78e+1 ││
││      │ 3.36e+1  4.62e+1  4.62e+1  5.07e+1 ││
│├──────┼────────────────────────────────────┤│
││3 @ 0 │ 3.86e+1  4.65e+1  4.22e+1  4.73e+1 ││
││axis 1│ 6.12e+1  8.15e+1  7.35e+1  8.38e+1 ││
││      │ 6.52e+1  8.67e+1  7.78e+1  8.92e+1 ││
││      │ 6.91e+1  9.19e+1  8.22e+1  9.45e+1 ││
││      │ 4.66e+1  6.33e+1  6.22e+1  6.94e+1 ││
│├──────┼────────────────────────────────────┤│
││4 @ 0 │ 3.42e+1  5.08e+1  3.43e+1  3.44e+1 ││
││axis 1│ 5.24e+1  7.37e+1  5.99e+1  6.09e+1 ││
││      │ 5.53e+1  7.76e+1  6.29e+1  6.43e+1 ││
││      │ 5.81e+1  8.14e+1  6.59e+1  6.77e+1 ││
││      │ 4.03e+1  5.20e+1  5.09e+1  4.26e+1 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘

Testing conv2d with use_padding=false reduces dimensions...
Input shape: 5x5x1
Kernel size: 3x3
Stride: 1
use_padding: false
out_channels: 4
Expected output spatial dims: 3x3 (reduced by kernel_size-1)
HERE: test/einsum/test_conv_padding.ml:65:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:3,1:3,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 2.18e+1  2.95e+1  3.04e+1  3.04e+1 ││
││axis 1│ 2.57e+1  3.47e+1  3.47e+1  3.57e+1 ││
││      │ 2.97e+1  3.99e+1  3.90e+1  4.11e+1 ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 4.15e+1  5.55e+1  5.19e+1  5.71e+1 ││
││axis 1│ 4.54e+1  6.07e+1  5.63e+1  6.24e+1 ││
││      │ 4.94e+1  6.59e+1  6.06e+1  6.78e+1 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 6.12e+1  8.15e+1  7.35e+1  8.38e+1 ││
││axis 1│ 6.52e+1  8.67e+1  7.78e+1  8.92e+1 ││
││      │ 6.91e+1  9.19e+1  8.22e+1  9.45e+1 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘

Testing conv2d with stride=2 and use_padding=true...
Input shape: 6x6x1
Kernel size: 3x3
Stride: 2
use_padding: true
out_channels: 4
Expected output spatial dims: 3x3 (input/stride)
HERE: test/einsum/test_conv_padding.ml:95:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:3,1:3,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 4.91     3.87     5.90     7.70    ││
││axis 1│ 1.14e+1  1.47e+1  1.57e+1  1.74e+1 ││
││      │ 1.64e+1  2.19e+1  2.37e+1  2.38e+1 ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 3.05e+1  3.63e+1  3.56e+1  3.76e+1 ││
││axis 1│ 5.30e+1  7.08e+1  6.59e+1  7.29e+1 ││
││      │ 6.08e+1  8.12e+1  7.46e+1  8.36e+1 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 6.17e+1  7.48e+1  6.54e+1  7.52e+1 ││
││axis 1│ 1.00e+2  1.33e+2  1.17e+2  1.37e+2 ││
││      │ 1.08e+2  1.43e+2  1.26e+2  1.47e+2 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘

Input: single prec 6+3x6+3x1

Testing backprop for conv2d with stride=2 and use_padding=true...
Input shape: 6x6x1
Kernel size: 3x3
Stride: 2
use_padding: true
out_channels: 4
Backprop completed successfully!
HERE: test/einsum/test_conv_padding.ml:127:21
┌────────────────────────┐
│[14]: =>_loss shape 0:1 │
│┌┬─────────┐            │
│││axis 0   │            │
│├┼─────────┤            │
│││ 2.16e+3 │            │
│└┴─────────┘            │
└────────────────────────┘
grad_=>_loss <not-hosted>
Testing conv2d with stride=2 and use_padding=false...
Input shape: 9x9x1
Kernel size: 3x3
Stride: 2
use_padding: false
out_channels: 4
Expected output spatial dims: 4x4 ((9-3)/2 + 1)
HERE: test/einsum/test_conv_padding.ml:159:21
┌─────────────────────────────────────────────┐
│[12]: +_conv2d shape 0:4,1:4,2:4             │
│┌──────┬────────────────────────────────────┐│
││      │axis 2                              ││
│├──────┼────────────────────────────────────┤│
││0 @ 0 │ 3.61e+1  4.92e+1  5.18e+1  5.09e+1 ││
││axis 1│ 4.40e+1  5.96e+1  6.04e+1  6.16e+1 ││
││      │ 5.18e+1  7.00e+1  6.91e+1  7.23e+1 ││
││      │ 5.97e+1  8.04e+1  7.77e+1  8.30e+1 ││
│├──────┼────────────────────────────────────┤│
││1 @ 0 │ 1.07e+2  1.42e+2  1.29e+2  1.47e+2 ││
││axis 1│ 1.15e+2  1.53e+2  1.38e+2  1.57e+2 ││
││      │ 1.22e+2  1.63e+2  1.46e+2  1.68e+2 ││
││      │ 1.30e+2  1.74e+2  1.55e+2  1.79e+2 ││
│├──────┼────────────────────────────────────┤│
││2 @ 0 │ 1.78e+2  2.36e+2  2.07e+2  2.43e+2 ││
││axis 1│ 1.86e+2  2.46e+2  2.15e+2  2.54e+2 ││
││      │ 1.93e+2  2.57e+2  2.24e+2  2.64e+2 ││
││      │ 2.01e+2  2.67e+2  2.33e+2  2.75e+2 ││
│├──────┼────────────────────────────────────┤│
││3 @ 0 │ 2.49e+2  3.29e+2  2.84e+2  3.39e+2 ││
││axis 1│ 2.57e+2  3.40e+2  2.93e+2  3.50e+2 ││
││      │ 2.64e+2  3.50e+2  3.02e+2  3.60e+2 ││
││      │ 2.72e+2  3.61e+2  3.10e+2  3.71e+2 ││
│└──────┴────────────────────────────────────┘│
└─────────────────────────────────────────────┘


Testing backprop for conv2d with stride=2 and use_padding=false...
Input shape: 9x9x1
Kernel size: 3x3
Stride: 2
use_padding: false
out_channels: 4
Expected output shape: 4x4 ((9-3)/2 + 1)
Backprop completed successfully!
HERE: test/einsum/test_conv_padding.ml:198:21
┌────────────────────────┐
│[14]: =>_loss shape 0:1 │
│┌┬─────────┐            │
│││axis 0   │            │
│├┼─────────┤            │
│││ 1.20e+4 │            │
│└┴─────────┘            │
└────────────────────────┘
grad_=>_loss <not-hosted>

All conv padding tests completed!
