Retrieving commandline, environment, or config file variable ocannl_log_level
Found 0, in the config file
Testing conv2d with use_padding=true preserves dimensions...
Input shape: 5x5x1
Kernel size: 3x3
Stride: 1
use_padding: true
Expected output spatial dims: 5x5 (same as input)
HERE: test/einsum/test_conv_padding.ml:33:21
┌────────────────────────────────────┐
│[12]: +_conv2d shape 0:5,1:5,2:4    │
│┌──────┬───────────────────────────┐│
││      │axis 2                     ││
│├──────┼───────────────────────────┤│
││0 @ 0 │ 0.00     0.00  0.00  0.00 ││
││axis 1│ 0.00     0.00  0.00  0.00 ││
││      │ 4.23e-1  0.00  0.00  0.00 ││
││      │ 8.46e-1  0.00  0.00  0.00 ││
││      │ 1.27     0.00  0.00  0.00 ││
│├──────┼───────────────────────────┤│
││1 @ 0 │ 9.08e-1  0.00  0.00  0.00 ││
││axis 1│ 4.50     0.00  0.00  0.00 ││
││      │ 6.65     0.00  0.00  0.00 ││
││      │ 8.79     0.00  0.00  0.00 ││
││      │ 6.39     0.00  0.00  0.00 ││
│├──────┼───────────────────────────┤│
││2 @ 0 │ 8.33     0.00  0.00  0.00 ││
││axis 1│ 1.52e+1  0.00  0.00  0.00 ││
││      │ 1.73e+1  0.00  0.00  0.00 ││
││      │ 1.95e+1  0.00  0.00  0.00 ││
││      │ 1.25e+1  0.00  0.00  0.00 ││
│├──────┼───────────────────────────┤│
││3 @ 0 │ 1.57e+1  0.00  0.00  0.00 ││
││axis 1│ 2.59e+1  0.00  0.00  0.00 ││
││      │ 2.80e+1  0.00  0.00  0.00 ││
││      │ 3.02e+1  0.00  0.00  0.00 ││
││      │ 1.87e+1  0.00  0.00  0.00 ││
│├──────┼───────────────────────────┤│
││4 @ 0 │ 2.31e+1  0.00  0.00  0.00 ││
││axis 1│ 3.66e+1  0.00  0.00  0.00 ││
││      │ 3.87e+1  0.00  0.00  0.00 ││
││      │ 4.09e+1  0.00  0.00  0.00 ││
││      │ 2.49e+1  0.00  0.00  0.00 ││
│└──────┴───────────────────────────┘│
└────────────────────────────────────┘

Testing conv2d with use_padding=false reduces dimensions...
Input shape: 5x5x1
Kernel size: 3x3
Stride: 1
use_padding: false
Expected output spatial dims: 3x3 (reduced by kernel_size-1)
HERE: test/einsum/test_conv_padding.ml:61:21
┌────────────────────────────────────┐
│[12]: +_conv2d shape 0:3,1:3,2:4    │
│┌──────┬───────────────────────────┐│
││      │axis 2                     ││
│├──────┼───────────────────────────┤│
││0 @ 0 │ 4.50  0.00  0.00  0.00    ││
││axis 1│ 6.65  0.00  0.00  0.00    ││
││      │ 8.79  0.00  0.00  0.00    ││
│├──────┼───────────────────────────┤│
││1 @ 0 │ 1.52e+1  0.00  0.00  0.00 ││
││axis 1│ 1.73e+1  0.00  0.00  0.00 ││
││      │ 1.95e+1  0.00  0.00  0.00 ││
│├──────┼───────────────────────────┤│
││2 @ 0 │ 2.59e+1  0.00  0.00  0.00 ││
││axis 1│ 2.80e+1  0.00  0.00  0.00 ││
││      │ 3.02e+1  0.00  0.00  0.00 ││
│└──────┴───────────────────────────┘│
└────────────────────────────────────┘

Testing conv2d with stride=2 and use_padding=true...
Input shape: 6x6x1
Kernel size: 3x3
Stride: 2
use_padding: true
Expected output spatial dims: 3x3 (input/stride)
HERE: test/einsum/test_conv_padding.ml:89:21
┌────────────────────────────────────┐
│[12]: +_conv2d shape 0:3,1:3,2:4    │
│┌──────┬───────────────────────────┐│
││      │axis 2                     ││
│├──────┼───────────────────────────┤│
││0 @ 0 │ 0.00     0.00  0.00  0.00 ││
││axis 1│ 4.23e-1  0.00  0.00  0.00 ││
││      │ 1.27     0.00  0.00  0.00 ││
│├──────┼───────────────────────────┤│
││1 @ 0 │ 9.81     0.00  0.00  0.00 ││
││axis 1│ 1.99e+1  0.00  0.00  0.00 ││
││      │ 2.42e+1  0.00  0.00  0.00 ││
│├──────┼───────────────────────────┤│
││2 @ 0 │ 2.76e+1  0.00  0.00  0.00 ││
││axis 1│ 4.56e+1  0.00  0.00  0.00 ││
││      │ 4.99e+1  0.00  0.00  0.00 ││
│└──────┴───────────────────────────┘│
└────────────────────────────────────┘

Input: single prec 6+3x6+3x1

Testing backprop for conv2d with stride=2 and use_padding=true...
Input shape: 6x6x1
Kernel size: 3x3
Stride: 2
use_padding: true
Backprop completed successfully!
HERE: test/einsum/test_conv_padding.ml:119:21
┌────────────────────────┐
│[14]: =>_loss shape 0:1 │
│┌┬─────────┐            │
│││axis 0   │            │
│├┼─────────┤            │
│││ 1.78e+2 │            │
│└┴─────────┘            │
└────────────────────────┘
grad_=>_loss <not-hosted>
Testing conv2d with stride=2 and use_padding=false...
Input shape: 9x9x1
Kernel size: 3x3
Stride: 2
use_padding: false
Expected output spatial dims: 4x4 ((9-3)/2 + 1)
HERE: test/einsum/test_conv_padding.ml:149:21
┌────────────────────────────────────┐
│[12]: +_conv2d shape 0:4,1:4,2:4    │
│┌──────┬───────────────────────────┐│
││      │axis 2                     ││
│├──────┼───────────────────────────┤│
││0 @ 0 │ 6.20     0.00  0.00  0.00 ││
││axis 1│ 1.04e+1  0.00  0.00  0.00 ││
││      │ 1.47e+1  0.00  0.00  0.00 ││
││      │ 1.90e+1  0.00  0.00  0.00 ││
│├──────┼───────────────────────────┤│
││1 @ 0 │ 4.47e+1  0.00  0.00  0.00 ││
││axis 1│ 4.90e+1  0.00  0.00  0.00 ││
││      │ 5.33e+1  0.00  0.00  0.00 ││
││      │ 5.76e+1  0.00  0.00  0.00 ││
│├──────┼───────────────────────────┤│
││2 @ 0 │ 8.33e+1  0.00  0.00  0.00 ││
││axis 1│ 8.75e+1  0.00  0.00  0.00 ││
││      │ 9.18e+1  0.00  0.00  0.00 ││
││      │ 9.61e+1  0.00  0.00  0.00 ││
│├──────┼───────────────────────────┤│
││3 @ 0 │ 1.21e+2  0.00  0.00  0.00 ││
││axis 1│ 1.26e+2  0.00  0.00  0.00 ││
││      │ 1.30e+2  0.00  0.00  0.00 ││
││      │ 1.34e+2  0.00  0.00  0.00 ││
│└──────┴───────────────────────────┘│
└────────────────────────────────────┘


Testing backprop for conv2d with stride=2 and use_padding=false...
Input shape: 9x9x1
Kernel size: 3x3
Stride: 2
use_padding: false
Expected output shape: 4x4 ((9-3)/2 + 1)
Backprop completed successfully!
HERE: test/einsum/test_conv_padding.ml:186:21
┌────────────────────────┐
│[14]: =>_loss shape 0:1 │
│┌┬─────────┐            │
│││axis 0   │            │
│├┼─────────┤            │
│││ 1.12e+3 │            │
│└┴─────────┘            │
└────────────────────────┘
grad_=>_loss <not-hosted>

All conv padding tests completed!
