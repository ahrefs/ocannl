<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>With_buffer_retrieval_and_syncing (arrayjit.Arrayjit.Backend_intf.With_buffer_retrieval_and_syncing)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">arrayjit</a> &#x00BB; <a href="../../index.html">Arrayjit</a> &#x00BB; <a href="../index.html">Backend_intf</a> &#x00BB; With_buffer_retrieval_and_syncing</nav><header class="odoc-preamble"><h1>Module type <code><span>Backend_intf.With_buffer_retrieval_and_syncing</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-context"><a href="#type-context" class="anchor"></a><code><span><span class="keyword">type</span> context</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-event"><a href="#type-event" class="anchor"></a><code><span><span class="keyword">type</span> event</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-from_host"><a href="#val-from_host" class="anchor"></a><code><span><span class="keyword">val</span> from_host : <span><a href="#type-context">context</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Tnode/index.html#type-t">Tnode.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div><div class="spec-doc"><p>If the tensor node is both hosted and in-context, schedules a copy from host to context and returns true, otherwise returns false.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_host"><a href="#val-to_host" class="anchor"></a><code><span><span class="keyword">val</span> to_host : <span><a href="#type-context">context</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Tnode/index.html#type-t">Tnode.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div><div class="spec-doc"><p>If the tensor node is both hosted and in-context, schedules a copy from context to host and returns true, otherwise returns false.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-device_to_device"><a href="#val-device_to_device" class="anchor"></a><code><span><span class="keyword">val</span> device_to_device : 
  <span><a href="../../Tnode/index.html#type-t">Tnode.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">into_merge_buffer</span>:<a href="../index.html#type-merge_buffer_use">merge_buffer_use</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dst</span>:<a href="#type-context">context</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">src</span>:<a href="#type-context">context</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base</span>.bool</span></code></div><div class="spec-doc"><p><code>device_to_device tn ~into_merge_buffer ~dst ~src</code> proceeds as follows:</p><ul><li>If the node is absent from the <code>src</code> context and either it is present in the <code>dst</code> context or <code>into_merge_buffer</code> is different from <code>No</code>: raises an error.</li><li>If the node is absent from <code>dst</code> and <code>into_merge_buffer=No</code>: returns false.</li><li>Schedules waiting for writing into the tensor node on <code>src</code> to finish, if any.</li><li>If <code>into_merge_buffer=No</code>: schedules a copy of the tensor node from <code>src</code> to <code>dst</code> and updates the writer event for the node.</li><li>If <code>into_merge_buffer</code> is different from <code>No</code>: sets on <code>dst</code> the merge buffer source to the given node.</li><li>If <code>into_merge_buffer=Streaming</code>, remembers the buffer pointer of the source node to use for streaming.</li><li>If <code>into_merge_buffer=Copy</code>, schedules copying from <code>src</code> to the merge buffer of <code>dst</code>'s stream, and updates the writer event for the merge buffer.</li></ul><p>NOTE: If <code>into_merge_buffer=Streaming</code>, after scheduling the work on <code>dst</code> using the merge buffer but before scheduling work on <code>src</code> that modifies <code>tn</code>, execute <code>will_wait_for src (all_work (get_ctx_stream dst))</code>.</p></div></div></div></body></html>
