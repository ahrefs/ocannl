<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Low_level (arrayjit.Arrayjit.Low_level)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">arrayjit</a> &#x00BB; <a href="../index.html">Arrayjit</a> &#x00BB; Low_level</nav><header class="odoc-preamble"><h1>Module <code><span>Arrayjit.Low_level</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#a-for-loop-based-array-language-and-backend-agnostic-optimization">A for-loop-based array language and backend-agnostic optimization</a><ul><li><a href="#low-level-representation">Low-level representation</a></li><li><a href="#optimization">Optimization</a></li><li><a href="#printing">Printing</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="a-for-loop-based-array-language-and-backend-agnostic-optimization"><a href="#a-for-loop-based-array-language-and-backend-agnostic-optimization" class="anchor"></a>A for-loop-based array language and backend-agnostic optimization</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Scope_id"><a href="#module-Scope_id" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Scope_id/index.html">Scope_id</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-scope_id"><a href="#type-scope_id" class="anchor"></a><code><span><span class="keyword">type</span> scope_id</span><span> = <a href="Scope_id/index.html#type-t">Scope_id.t</a></span><span> = </span><span>{</span></code><ol><li id="type-scope_id.tn" class="def record field anchored"><a href="#type-scope_id.tn" class="anchor"></a><code><span>tn : <a href="../Tnode/index.html#type-t">Tnode.t</a>;</span></code></li><li id="type-scope_id.scope_id" class="def record field anchored"><a href="#type-scope_id.scope_id" class="anchor"></a><code><span>scope_id : <span class="xref-unresolved">Base</span>.int;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_scope_id"><a href="#val-sexp_of_scope_id" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_scope_id : <span><a href="#type-scope_id">scope_id</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_scope_id"><a href="#val-equal_scope_id" class="anchor"></a><code><span><span class="keyword">val</span> equal_scope_id : <span><a href="#type-scope_id">scope_id</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-scope_id">scope_id</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hash_fold_scope_id"><a href="#val-hash_fold_scope_id" class="anchor"></a><code><span><span class="keyword">val</span> hash_fold_scope_id : 
  <span><span class="xref-unresolved">Ppx_hash_lib</span>.Std.Hash.state <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-scope_id">scope_id</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Ppx_hash_lib</span>.Std.Hash.state</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hash_scope_id"><a href="#val-hash_scope_id" class="anchor"></a><code><span><span class="keyword">val</span> hash_scope_id : <span><a href="#type-scope_id">scope_id</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_hash_lib</span>.Std.Hash.hash_value</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare_scope_id"><a href="#val-compare_scope_id" class="anchor"></a><code><span><span class="keyword">val</span> compare_scope_id : <span><a href="#type-scope_id">scope_id</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-scope_id">scope_id</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><h3 id="low-level-representation"><a href="#low-level-representation" class="anchor"></a>Low-level representation</h3><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span></code><ol><li id="type-t.Noop" class="def variant constructor anchored"><a href="#type-t.Noop" class="anchor"></a><code><span>| </span><span><span class="constructor">Noop</span></span></code></li><li id="type-t.Comment" class="def variant constructor anchored"><a href="#type-t.Comment" class="anchor"></a><code><span>| </span><span><span class="constructor">Comment</span> <span class="keyword">of</span> <span class="xref-unresolved">Base</span>.string</span></code></li><li id="type-t.Staged_compilation" class="def variant constructor anchored"><a href="#type-t.Staged_compilation" class="anchor"></a><code><span>| </span><span><span class="constructor">Staged_compilation</span> <span class="keyword">of</span> <span><span class="xref-unresolved">Base</span>.unit <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.unit</span></code></li><li id="type-t.Seq" class="def variant constructor anchored"><a href="#type-t.Seq" class="anchor"></a><code><span>| </span><span><span class="constructor">Seq</span> <span class="keyword">of</span> <a href="#type-t">t</a> * <a href="#type-t">t</a></span></code></li><li id="type-t.For_loop" class="def variant constructor anchored"><a href="#type-t.For_loop" class="anchor"></a><code><span>| </span><span><span class="constructor">For_loop</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-t.index" class="def record field anchored"><a href="#type-t.index" class="anchor"></a><code><span>index : <a href="../Indexing/index.html#type-symbol">Indexing.symbol</a>;</span></code></li><li id="type-t.from_" class="def record field anchored"><a href="#type-t.from_" class="anchor"></a><code><span>from_ : <span class="xref-unresolved">Base</span>.int;</span></code></li><li id="type-t.to_" class="def record field anchored"><a href="#type-t.to_" class="anchor"></a><code><span>to_ : <span class="xref-unresolved">Base</span>.int;</span></code></li><li id="type-t.body" class="def record field anchored"><a href="#type-t.body" class="anchor"></a><code><span>body : <a href="#type-t">t</a>;</span></code></li><li id="type-t.trace_it" class="def record field anchored"><a href="#type-t.trace_it" class="anchor"></a><code><span>trace_it : <span class="xref-unresolved">Base</span>.bool;</span></code></li></ol><code><span>}</span></code></li><li id="type-t.Zero_out" class="def variant constructor anchored"><a href="#type-t.Zero_out" class="anchor"></a><code><span>| </span><span><span class="constructor">Zero_out</span> <span class="keyword">of</span> <a href="../Tnode/index.html#type-t">Tnode.t</a></span></code></li><li id="type-t.Set" class="def variant constructor anchored"><a href="#type-t.Set" class="anchor"></a><code><span>| </span><span><span class="constructor">Set</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-t.tn" class="def record field anchored"><a href="#type-t.tn" class="anchor"></a><code><span>tn : <a href="../Tnode/index.html#type-t">Tnode.t</a>;</span></code></li><li id="type-t.idcs" class="def record field anchored"><a href="#type-t.idcs" class="anchor"></a><code><span>idcs : <span><a href="../Indexing/index.html#type-axis_index">Indexing.axis_index</a> <span class="xref-unresolved">Base</span>.array</span>;</span></code></li><li id="type-t.llv" class="def record field anchored"><a href="#type-t.llv" class="anchor"></a><code><span>llv : <a href="#type-float_t">float_t</a>;</span></code></li><li id="type-t.debug" class="def record field anchored"><a href="#type-t.debug" class="anchor"></a><code><span><span class="keyword">mutable</span> debug : <span class="xref-unresolved">Base</span>.string;</span></code></li></ol><code><span>}</span></code></li><li id="type-t.Set_local" class="def variant constructor anchored"><a href="#type-t.Set_local" class="anchor"></a><code><span>| </span><span><span class="constructor">Set_local</span> <span class="keyword">of</span> <a href="#type-scope_id">scope_id</a> * <a href="#type-float_t">float_t</a></span></code></li></ol></div><div class="spec-doc"><p>Cases: <code>t</code> -- code, <code>float_t</code> -- single number at some precision.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-float_t"><a href="#type-float_t" class="anchor"></a><code><span><span class="keyword">and</span> float_t</span><span> = </span></code><ol><li id="type-float_t.Local_scope" class="def variant constructor anchored"><a href="#type-float_t.Local_scope" class="anchor"></a><code><span>| </span><span><span class="constructor">Local_scope</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-float_t.id" class="def record field anchored"><a href="#type-float_t.id" class="anchor"></a><code><span>id : <a href="#type-scope_id">scope_id</a>;</span></code></li><li id="type-float_t.body" class="def record field anchored"><a href="#type-float_t.body" class="anchor"></a><code><span>body : <a href="#type-t">t</a>;</span></code></li><li id="type-float_t.orig_indices" class="def record field anchored"><a href="#type-float_t.orig_indices" class="anchor"></a><code><span>orig_indices : <span><a href="../Indexing/index.html#type-axis_index">Indexing.axis_index</a> <span class="xref-unresolved">Base</span>.array</span>;</span></code></li></ol><code><span>}</span></code></li><li id="type-float_t.Get_local" class="def variant constructor anchored"><a href="#type-float_t.Get_local" class="anchor"></a><code><span>| </span><span><span class="constructor">Get_local</span> <span class="keyword">of</span> <a href="#type-scope_id">scope_id</a></span></code></li><li id="type-float_t.Get_global" class="def variant constructor anchored"><a href="#type-float_t.Get_global" class="anchor"></a><code><span>| </span><span><span class="constructor">Get_global</span> <span class="keyword">of</span> <a href="../Ops/index.html#type-global_identifier">Ops.global_identifier</a>
  * <span><span><a href="../Indexing/index.html#type-axis_index">Indexing.axis_index</a> <span class="xref-unresolved">Base</span>.array</span> <span class="xref-unresolved">Base</span>.option</span></span></code></li><li id="type-float_t.Get" class="def variant constructor anchored"><a href="#type-float_t.Get" class="anchor"></a><code><span>| </span><span><span class="constructor">Get</span> <span class="keyword">of</span> <a href="../Tnode/index.html#type-t">Tnode.t</a> * <span><a href="../Indexing/index.html#type-axis_index">Indexing.axis_index</a> <span class="xref-unresolved">Base</span>.array</span></span></code></li><li id="type-float_t.Binop" class="def variant constructor anchored"><a href="#type-float_t.Binop" class="anchor"></a><code><span>| </span><span><span class="constructor">Binop</span> <span class="keyword">of</span> <a href="../Ops/index.html#type-binop">Ops.binop</a> * <a href="#type-float_t">float_t</a> * <a href="#type-float_t">float_t</a></span></code></li><li id="type-float_t.Unop" class="def variant constructor anchored"><a href="#type-float_t.Unop" class="anchor"></a><code><span>| </span><span><span class="constructor">Unop</span> <span class="keyword">of</span> <a href="../Ops/index.html#type-unop">Ops.unop</a> * <a href="#type-float_t">float_t</a></span></code></li><li id="type-float_t.Constant" class="def variant constructor anchored"><a href="#type-float_t.Constant" class="anchor"></a><code><span>| </span><span><span class="constructor">Constant</span> <span class="keyword">of</span> <span class="xref-unresolved">Base</span>.float</span></code></li><li id="type-float_t.Embed_index" class="def variant constructor anchored"><a href="#type-float_t.Embed_index" class="anchor"></a><code><span>| </span><span><span class="constructor">Embed_index</span> <span class="keyword">of</span> <a href="../Indexing/index.html#type-axis_index">Indexing.axis_index</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_t : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_float_t"><a href="#val-sexp_of_float_t" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_float_t : <span><a href="#type-float_t">float_t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_float_t"><a href="#val-equal_float_t" class="anchor"></a><code><span><span class="keyword">val</span> equal_float_t : <span><a href="#type-float_t">float_t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-float_t">float_t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span><span class="keyword">val</span> compare : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare_float_t"><a href="#val-compare_float_t" class="anchor"></a><code><span><span class="keyword">val</span> compare_float_t : <span><a href="#type-float_t">float_t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-float_t">float_t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-binop"><a href="#val-binop" class="anchor"></a><code><span><span class="keyword">val</span> binop : <span><span class="label">op</span>:<a href="../Ops/index.html#type-binop">Ops.binop</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">rhs1</span>:<a href="#type-float_t">float_t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">rhs2</span>:<a href="#type-float_t">float_t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-float_t">float_t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unop"><a href="#val-unop" class="anchor"></a><code><span><span class="keyword">val</span> unop : <span><span class="label">op</span>:<a href="../Ops/index.html#type-unop">Ops.unop</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">rhs</span>:<a href="#type-float_t">float_t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-float_t">float_t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-flat_lines"><a href="#val-flat_lines" class="anchor"></a><code><span><span class="keyword">val</span> flat_lines : <span><span><a href="#type-t">t</a> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="xref-unresolved">Base</span>.list</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unflat_lines"><a href="#val-unflat_lines" class="anchor"></a><code><span><span class="keyword">val</span> unflat_lines : <span><span><a href="#type-t">t</a> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-loop_over_dims"><a href="#val-loop_over_dims" class="anchor"></a><code><span><span class="keyword">val</span> loop_over_dims : 
  <span><span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">body</span>:<span>(<span><span><a href="../Indexing/index.html#type-axis_index">Indexing.axis_index</a> <span class="xref-unresolved">Base</span>.array</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div></div><h3 id="optimization"><a href="#optimization" class="anchor"></a>Optimization</h3><div class="odoc-spec"><div class="spec type anchored" id="type-virtualize_settings"><a href="#type-virtualize_settings" class="anchor"></a><code><span><span class="keyword">type</span> virtualize_settings</span><span> = </span><span>{</span></code><ol><li id="type-virtualize_settings.enable_device_only" class="def record field anchored"><a href="#type-virtualize_settings.enable_device_only" class="anchor"></a><code><span><span class="keyword">mutable</span> enable_device_only : <span class="xref-unresolved">Base</span>.bool;</span></code></li><li id="type-virtualize_settings.max_visits" class="def record field anchored"><a href="#type-virtualize_settings.max_visits" class="anchor"></a><code><span><span class="keyword">mutable</span> max_visits : <span class="xref-unresolved">Base</span>.int;</span></code></li><li id="type-virtualize_settings.max_tracing_dim" class="def record field anchored"><a href="#type-virtualize_settings.max_tracing_dim" class="anchor"></a><code><span><span class="keyword">mutable</span> max_tracing_dim : <span class="xref-unresolved">Base</span>.int;</span></code></li><li id="type-virtualize_settings.inline_scalar_constexprs" class="def record field anchored"><a href="#type-virtualize_settings.inline_scalar_constexprs" class="anchor"></a><code><span><span class="keyword">mutable</span> inline_scalar_constexprs : <span class="xref-unresolved">Base</span>.bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-virtualize_settings"><a href="#val-virtualize_settings" class="anchor"></a><code><span><span class="keyword">val</span> virtualize_settings : <a href="#type-virtualize_settings">virtualize_settings</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-visits"><a href="#type-visits" class="anchor"></a><code><span><span class="keyword">type</span> visits</span><span> = </span></code><ol><li id="type-visits.Visits" class="def variant constructor anchored"><a href="#type-visits.Visits" class="anchor"></a><code><span>| </span><span><span class="constructor">Visits</span> <span class="keyword">of</span> <span class="xref-unresolved">Base</span>.int</span></code></li><li id="type-visits.Recurrent" class="def variant constructor anchored"><a href="#type-visits.Recurrent" class="anchor"></a><code><span>| </span><span><span class="constructor">Recurrent</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A <code>Recurrent</code> visit is when there is an access prior to any assignment in an update.</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_visits"><a href="#val-sexp_of_visits" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_visits : <span><a href="#type-visits">visits</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-visits_of_sexp"><a href="#val-visits_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> visits_of_sexp : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-visits">visits</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_visits"><a href="#val-equal_visits" class="anchor"></a><code><span><span class="keyword">val</span> equal_visits : <span><a href="#type-visits">visits</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-visits">visits</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-visits"><a href="#val-visits" class="anchor"></a><code><span><span class="keyword">val</span> visits : <span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> <a href="#type-visits">visits</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-recurrent"><a href="#val-recurrent" class="anchor"></a><code><span><span class="keyword">val</span> recurrent : <a href="#type-visits">visits</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_visits"><a href="#val-is_visits" class="anchor"></a><code><span><span class="keyword">val</span> is_visits : <span><a href="#type-visits">visits</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_recurrent"><a href="#val-is_recurrent" class="anchor"></a><code><span><span class="keyword">val</span> is_recurrent : <span><a href="#type-visits">visits</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-visits_val"><a href="#val-visits_val" class="anchor"></a><code><span><span class="keyword">val</span> visits_val : <span><a href="#type-visits">visits</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-recurrent_val"><a href="#val-recurrent_val" class="anchor"></a><code><span><span class="keyword">val</span> recurrent_val : <span><a href="#type-visits">visits</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.unit <span class="xref-unresolved">Base</span>.option</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Variants_of_visits"><a href="#module-Variants_of_visits" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Variants_of_visits/index.html">Variants_of_visits</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-traced_array"><a href="#type-traced_array" class="anchor"></a><code><span><span class="keyword">type</span> traced_array</span><span> = </span><span>{</span></code><ol><li id="type-traced_array.tn" class="def record field anchored"><a href="#type-traced_array.tn" class="anchor"></a><code><span>tn : <a href="../Tnode/index.html#type-t">Tnode.t</a>;</span></code></li><li id="type-traced_array.computations" class="def record field anchored"><a href="#type-traced_array.computations" class="anchor"></a><code><span><span class="keyword">mutable</span> computations : <span><span>(<span><span><a href="../Indexing/index.html#type-axis_index">Indexing.axis_index</a> <span class="xref-unresolved">Base</span>.array</span> <span class="xref-unresolved">Base</span>.option</span> * <a href="#type-t">t</a>)</span>
                         <span class="xref-unresolved">Base</span>.list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The computations (of the tensor node) are retrieved for optimization just as they are populated, so that the inlined code corresponds precisely to the changes to the arrays that would happen up till that point. Within the code blocks paired with an index tuple, all assignments and accesses must happen via the index tuple; if this is not the case for some assignment, the node cannot be virtual. Currently, we only allow for-loop symbols in assignment indices of virtual nodes.</p><span class="comment-delim">*)</span></div></li><li id="type-traced_array.assignments" class="def record field anchored"><a href="#type-traced_array.assignments" class="anchor"></a><code><span>assignments : <span><span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.array</span> <span class="xref-unresolved">Base</span>.Hash_set.t</span>;</span></code></li><li id="type-traced_array.accesses" class="def record field anchored"><a href="#type-traced_array.accesses" class="anchor"></a><code><span>accesses : <span><span>(<span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.array</span>, <a href="#type-visits">visits</a>)</span> <span class="xref-unresolved">Base</span>.Hashtbl.t</span>;</span></code></li><li id="type-traced_array.zero_initialized" class="def record field anchored"><a href="#type-traced_array.zero_initialized" class="anchor"></a><code><span><span class="keyword">mutable</span> zero_initialized : <span class="xref-unresolved">Base</span>.bool;</span></code></li><li id="type-traced_array.zeroed_out" class="def record field anchored"><a href="#type-traced_array.zeroed_out" class="anchor"></a><code><span><span class="keyword">mutable</span> zeroed_out : <span class="xref-unresolved">Base</span>.bool;</span></code></li><li id="type-traced_array.read_before_write" class="def record field anchored"><a href="#type-traced_array.read_before_write" class="anchor"></a><code><span><span class="keyword">mutable</span> read_before_write : <span class="xref-unresolved">Base</span>.bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The node is read before it is written (i.e. it is recurrent).</p><span class="comment-delim">*)</span></div></li><li id="type-traced_array.read_only" class="def record field anchored"><a href="#type-traced_array.read_only" class="anchor"></a><code><span><span class="keyword">mutable</span> read_only : <span class="xref-unresolved">Base</span>.bool;</span></code></li><li id="type-traced_array.is_scalar_constexpr" class="def record field anchored"><a href="#type-traced_array.is_scalar_constexpr" class="anchor"></a><code><span><span class="keyword">mutable</span> is_scalar_constexpr : <span class="xref-unresolved">Base</span>.bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>True only if the tensor node has all axes of dimension 1, is either zeroed-out or assigned before accessed, is assigned at most once, and from an expression involving only constants or tensor nodes that were at the time is_scalar_constexpr.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_traced_array"><a href="#val-sexp_of_traced_array" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_traced_array : <span><a href="#type-traced_array">traced_array</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_node"><a href="#val-get_node" class="anchor"></a><code><span><span class="keyword">val</span> get_node : 
  <span><span><span>(<a href="../Tnode/index.html#type-t">Tnode.t</a>, <a href="#type-traced_array">traced_array</a>)</span> <span class="xref-unresolved">Base</span>.Hashtbl.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Tnode/index.html#type-t">Tnode.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-traced_array">traced_array</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-optimize_integer_pow"><a href="#val-optimize_integer_pow" class="anchor"></a><code><span><span class="keyword">val</span> optimize_integer_pow : <span><span class="xref-unresolved">Base</span>.bool <span class="xref-unresolved">Base</span>.ref</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-traced_store"><a href="#type-traced_store" class="anchor"></a><code><span><span class="keyword">type</span> traced_store</span><span> = <span><span>(<a href="../Tnode/index.html#type-t">Tnode.t</a>, <a href="#type-traced_array">traced_array</a>)</span> <span class="xref-unresolved">Base</span>.Hashtbl.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_traced_store"><a href="#val-sexp_of_traced_store" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_traced_store : <span><a href="#type-traced_store">traced_store</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-optimized"><a href="#type-optimized" class="anchor"></a><code><span><span class="keyword">type</span> optimized</span><span> = </span><span>{</span></code><ol><li id="type-optimized.traced_store" class="def record field anchored"><a href="#type-optimized.traced_store" class="anchor"></a><code><span>traced_store : <a href="#type-traced_store">traced_store</a>;</span></code></li><li id="type-optimized.llc" class="def record field anchored"><a href="#type-optimized.llc" class="anchor"></a><code><span>llc : <a href="#type-t">t</a>;</span></code></li><li id="type-optimized.merge_node" class="def record field anchored"><a href="#type-optimized.merge_node" class="anchor"></a><code><span>merge_node : <span><a href="../Tnode/index.html#type-t">Tnode.t</a> <span class="xref-unresolved">Base</span>.option</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_optimized"><a href="#val-sexp_of_optimized" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_optimized : <span><a href="#type-optimized">optimized</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-optimize"><a href="#val-optimize" class="anchor"></a><code><span><span class="keyword">val</span> optimize : 
  <span><span class="label">unoptim_ll_source</span>:<span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="xref-unresolved">Base</span>.option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">ll_source</span>:<span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="xref-unresolved">Base</span>.option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">name</span>:<span class="xref-unresolved">Base</span>.string <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Indexing/index.html#type-static_symbol">Indexing.static_symbol</a> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-optimized">optimized</a></span></code></div></div><h3 id="printing"><a href="#printing" class="anchor"></a>Printing</h3><div class="odoc-spec"><div class="spec value anchored" id="val-code_hum_margin"><a href="#val-code_hum_margin" class="anchor"></a><code><span><span class="keyword">val</span> code_hum_margin : <span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.ref</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fprint_function_header"><a href="#val-fprint_function_header" class="anchor"></a><code><span><span class="keyword">val</span> fprint_function_header : 
  <span><span class="optlabel">?name</span>:<span class="xref-unresolved">Base</span>.string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?static_indices</span>:<span><a href="../Indexing/index.html#type-static_symbol">Indexing.static_symbol</a> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Base</span>.unit <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base</span>.unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_ident_within_code"><a href="#val-get_ident_within_code" class="anchor"></a><code><span><span class="keyword">val</span> get_ident_within_code : 
  <span><span class="optlabel">?no_dots</span>:<span class="xref-unresolved">Base</span>.bool <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-t">t</a> <span class="xref-unresolved">Base</span>.array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Tnode/index.html#type-t">Tnode.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base</span>.string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fprint_hum"><a href="#val-fprint_hum" class="anchor"></a><code><span><span class="keyword">val</span> fprint_hum : 
  <span><span class="optlabel">?name</span>:<span class="xref-unresolved">Base</span>.string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?static_indices</span>:<span><a href="../Indexing/index.html#type-static_symbol">Indexing.static_symbol</a> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Base</span>.unit <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base</span>.unit</span></code></div></div></div></body></html>
