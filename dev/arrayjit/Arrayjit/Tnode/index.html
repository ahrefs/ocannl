<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tnode (arrayjit.Arrayjit.Tnode)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">arrayjit</a> &#x00BB; <a href="../index.html">Arrayjit</a> &#x00BB; Tnode</nav><header class="odoc-preamble"><h1>Module <code><span>Arrayjit.Tnode</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-Lazy"><a href="#module-Lazy" class="anchor"></a><code><span><span class="keyword">module</span> Lazy</span><span> = <a href="../Utils/Lazy/index.html">Utils.Lazy</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Nd"><a href="#module-Nd" class="anchor"></a><code><span><span class="keyword">module</span> Nd</span><span> = <a href="../Ndarray/index.html">Ndarray</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Debug_runtime"><a href="#module-Debug_runtime" class="anchor"></a><code><span><span class="keyword">module</span> Debug_runtime</span><span> = <a href="../Utils/Debug_runtime/index.html">Utils.Debug_runtime</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-_get_local_debug_runtime"><a href="#val-_get_local_debug_runtime" class="anchor"></a><code><span><span class="keyword">val</span> _get_local_debug_runtime : <span>unit <span class="arrow">&#45;&gt;</span></span> <span>(<span class="keyword">module</span> <span class="xref-unresolved">Minidebug_runtime</span>.Debug_runtime)</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-sharing"><a href="#type-sharing" class="anchor"></a><code><span><span class="keyword">type</span> sharing</span><span> = </span></code><ol><li id="type-sharing.Unset" class="def variant constructor anchored"><a href="#type-sharing.Unset" class="anchor"></a><code><span>| </span><span><span class="constructor">Unset</span></span></code></li><li id="type-sharing.Per_stream" class="def variant constructor anchored"><a href="#type-sharing.Per_stream" class="anchor"></a><code><span>| </span><span><span class="constructor">Per_stream</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The tensor node has separate arrays for each stream.</p><span class="comment-delim">*)</span></div></li><li id="type-sharing.Shared_cross_stream" class="def variant constructor anchored"><a href="#type-sharing.Shared_cross_stream" class="anchor"></a><code><span>| </span><span><span class="constructor">Shared_cross_stream</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The tensor node has a single array per device that can appear in multiple contexts, except for backends with <code>use_host_memory = true</code> and nodes with memory mode <code>Hosted (Changed_on_devices Shared_cross_stream)</code>, where it only has the on-host array and does not appear in any contexts.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>A possible algorithm for deciding sharing within a single device:</p><ul><li>If a tensor node is read-only for a context, and not otherwise recorded, it is stored as a cross-stream sharing candidate.</li><li>If a cross-stream sharing candidate is read-only for another context, whose parent does not have the corresponding array (i.e. it is a different stream), it is recorded as cross-stream shared, and the same array is reused.</li><li>If a tensor node is writable by a context, and it is not cross-stream shared, it is marked as non-cross-stream, the array is removed from cross-stream sharing candidates if present. If it is cross-stream shared, it is recorded as owned by the corresponding stream. It is an error if the node was already owned by a different stream.</li></ul><p>If a tensor node is shared cross-stream, within-device copying is a NOOP as source and destination pointers are in that case identical.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sharing_of_sexp"><a href="#val-sharing_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> sharing_of_sexp : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-sharing">sharing</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_sharing"><a href="#val-sexp_of_sharing" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_sharing : <span><a href="#type-sharing">sharing</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare_sharing"><a href="#val-compare_sharing" class="anchor"></a><code><span><span class="keyword">val</span> compare_sharing : <span><a href="#type-sharing">sharing</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-sharing">sharing</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_sharing"><a href="#val-equal_sharing" class="anchor"></a><code><span><span class="keyword">val</span> equal_sharing : <span><a href="#type-sharing">sharing</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-sharing">sharing</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-memory_type"><a href="#type-memory_type" class="anchor"></a><code><span><span class="keyword">type</span> memory_type</span><span> = </span></code><ol><li id="type-memory_type.Constant" class="def variant constructor anchored"><a href="#type-memory_type.Constant" class="anchor"></a><code><span>| </span><span><span class="constructor">Constant</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The tensor node does not change after initialization.</p><span class="comment-delim">*)</span></div></li><li id="type-memory_type.Nonconstant" class="def variant constructor anchored"><a href="#type-memory_type.Nonconstant" class="anchor"></a><code><span>| </span><span><span class="constructor">Nonconstant</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>One of: <code>Changed_on_devices</code>, <code>Volatile</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-memory_type.Changed_on_devices" class="def variant constructor anchored"><a href="#type-memory_type.Changed_on_devices" class="anchor"></a><code><span>| </span><span><span class="constructor">Changed_on_devices</span> <span class="keyword">of</span> <a href="#type-sharing">sharing</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The tensor node will only change on host via a <code>to_host</code> call.</p><span class="comment-delim">*)</span></div></li><li id="type-memory_type.Volatile" class="def variant constructor anchored"><a href="#type-memory_type.Volatile" class="anchor"></a><code><span>| </span><span><span class="constructor">Volatile</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The tensor node will only change on any device via a <code>from_host</code> call possibly followed by <code>device_to_device</code>.</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-memory_type_of_sexp"><a href="#val-memory_type_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> memory_type_of_sexp : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-memory_type">memory_type</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_memory_type"><a href="#val-sexp_of_memory_type" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_memory_type : <span><a href="#type-memory_type">memory_type</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare_memory_type"><a href="#val-compare_memory_type" class="anchor"></a><code><span><span class="keyword">val</span> compare_memory_type : <span><a href="#type-memory_type">memory_type</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-memory_type">memory_type</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_memory_type"><a href="#val-equal_memory_type" class="anchor"></a><code><span><span class="keyword">val</span> equal_memory_type : <span><a href="#type-memory_type">memory_type</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-memory_type">memory_type</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-memory_mode"><a href="#type-memory_mode" class="anchor"></a><code><span><span class="keyword">type</span> memory_mode</span><span> = </span></code><ol><li id="type-memory_mode.Effectively_constant" class="def variant constructor anchored"><a href="#type-memory_mode.Effectively_constant" class="anchor"></a><code><span>| </span><span><span class="constructor">Effectively_constant</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Either <code>Hosted Constant</code>, or a subset of <code>Virtual</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-memory_mode.Virtual" class="def variant constructor anchored"><a href="#type-memory_mode.Virtual" class="anchor"></a><code><span>| </span><span><span class="constructor">Virtual</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The tensor node's computations are inlined on a per-scalar basis.</p><span class="comment-delim">*)</span></div></li><li id="type-memory_mode.Never_virtual" class="def variant constructor anchored"><a href="#type-memory_mode.Never_virtual" class="anchor"></a><code><span>| </span><span><span class="constructor">Never_virtual</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>One of: <code>Local</code>, <code>On_device</code>, <code>Hosted</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-memory_mode.Local" class="def variant constructor anchored"><a href="#type-memory_mode.Local" class="anchor"></a><code><span>| </span><span><span class="constructor">Local</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The full tensor node is cached for the duration of a computation but not persisted across calls to compiled functions. It is not available for merging across devices.</p><span class="comment-delim">*)</span></div></li><li id="type-memory_mode.Device_only" class="def variant constructor anchored"><a href="#type-memory_mode.Device_only" class="anchor"></a><code><span>| </span><span><span class="constructor">Device_only</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>One of: <code>Local</code>, <code>On_device</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-memory_mode.On_device" class="def variant constructor anchored"><a href="#type-memory_mode.On_device" class="anchor"></a><code><span>| </span><span><span class="constructor">On_device</span> <span class="keyword">of</span> <a href="#type-sharing">sharing</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The tensor node is stored on the devices that compute with it and persisted across function calls. It is available for merging across devices (for devices that support merging / P2P), but not (directly) for visualization or storing to disk.</p><span class="comment-delim">*)</span></div></li><li id="type-memory_mode.Materialized" class="def variant constructor anchored"><a href="#type-memory_mode.Materialized" class="anchor"></a><code><span>| </span><span><span class="constructor">Materialized</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>One of: <code>On_device</code>, <code>Hosted</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-memory_mode.Hosted" class="def variant constructor anchored"><a href="#type-memory_mode.Hosted" class="anchor"></a><code><span>| </span><span><span class="constructor">Hosted</span> <span class="keyword">of</span> <a href="#type-memory_type">memory_type</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The tensor node is stored in a globally addressable memory, in addition to on devices where it is computed with (or only on the host and not on the device, for some backends). It is available for all operations, and visible to OCaml programs as an <a href="../Ndarray/index.html"><code>Ndarray</code></a> (the optional <code>array</code> of <a href="#type-t"><code>t</code></a>).</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-memory_mode_of_sexp"><a href="#val-memory_mode_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> memory_mode_of_sexp : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-memory_mode">memory_mode</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_memory_mode"><a href="#val-sexp_of_memory_mode" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_memory_mode : <span><a href="#type-memory_mode">memory_mode</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare_memory_mode"><a href="#val-compare_memory_mode" class="anchor"></a><code><span><span class="keyword">val</span> compare_memory_mode : <span><a href="#type-memory_mode">memory_mode</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-memory_mode">memory_mode</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_memory_mode"><a href="#val-equal_memory_mode" class="anchor"></a><code><span><span class="keyword">val</span> equal_memory_mode : <span><a href="#type-memory_mode">memory_mode</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-memory_mode">memory_mode</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-delayed_prec"><a href="#type-delayed_prec" class="anchor"></a><code><span><span class="keyword">type</span> delayed_prec</span><span> = </span></code><ol><li id="type-delayed_prec.Not_specified" class="def variant constructor anchored"><a href="#type-delayed_prec.Not_specified" class="anchor"></a><code><span>| </span><span><span class="constructor">Not_specified</span></span></code></li><li id="type-delayed_prec.Default_spec" class="def variant constructor anchored"><a href="#type-delayed_prec.Default_spec" class="anchor"></a><code><span>| </span><span><span class="constructor">Default_spec</span> <span class="keyword">of</span> <span><a href="../Ops/index.html#type-prec">Ops.prec</a> <a href="../Utils/Lazy/index.html#type-t">Lazy.t</a></span></span></code></li><li id="type-delayed_prec.Specified" class="def variant constructor anchored"><a href="#type-delayed_prec.Specified" class="anchor"></a><code><span>| </span><span><span class="constructor">Specified</span> <span class="keyword">of</span> <a href="../Ops/index.html#type-prec">Ops.prec</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-delayed_prec_of_sexp"><a href="#val-delayed_prec_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> delayed_prec_of_sexp : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-delayed_prec">delayed_prec</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_delayed_prec"><a href="#val-sexp_of_delayed_prec" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_delayed_prec : <span><a href="#type-delayed_prec">delayed_prec</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_delayed_prec"><a href="#val-equal_delayed_prec" class="anchor"></a><code><span><span class="keyword">val</span> equal_delayed_prec : <span><a href="#type-delayed_prec">delayed_prec</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-delayed_prec">delayed_prec</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span><span>{</span></code><ol><li id="type-t.array" class="def record field anchored"><a href="#type-t.array" class="anchor"></a><code><span>array : <span><span><a href="../Ndarray/index.html#type-t">Nd.t</a> <span class="xref-unresolved">Base</span>.option</span> <a href="../Utils/Lazy/index.html#type-t">Lazy.t</a></span>;</span></code></li><li id="type-t.prec" class="def record field anchored"><a href="#type-t.prec" class="anchor"></a><code><span>prec : <span><a href="../Ops/index.html#type-prec">Ops.prec</a> <a href="../Utils/Lazy/index.html#type-t">Lazy.t</a></span>;</span></code></li><li id="type-t.dims" class="def record field anchored"><a href="#type-t.dims" class="anchor"></a><code><span>dims : <span><span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.array</span> <a href="../Utils/Lazy/index.html#type-t">Lazy.t</a></span>;</span></code></li><li id="type-t.id" class="def record field anchored"><a href="#type-t.id" class="anchor"></a><code><span>id : <span class="xref-unresolved">Base</span>.int;</span></code></li><li id="type-t.label" class="def record field anchored"><a href="#type-t.label" class="anchor"></a><code><span>label : <span><span class="xref-unresolved">Base</span>.string <span class="xref-unresolved">Base</span>.list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Display information. It is better if the last element of the list is the most narrow or alphanumeric, e.g. an identifier.</p><span class="comment-delim">*)</span></div></li><li id="type-t.delayed_prec_unsafe" class="def record field anchored"><a href="#type-t.delayed_prec_unsafe" class="anchor"></a><code><span><span class="keyword">mutable</span> delayed_prec_unsafe : <a href="#type-delayed_prec">delayed_prec</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Participates in the computation of <a href="#type-t.prec"><code>prec</code></a>.</p><span class="comment-delim">*)</span></div></li><li id="type-t.memory_mode" class="def record field anchored"><a href="#type-t.memory_mode" class="anchor"></a><code><span><span class="keyword">mutable</span> memory_mode : <span><span>(<a href="#type-memory_mode">memory_mode</a> * <span class="xref-unresolved">Base</span>.int)</span> <span class="xref-unresolved">Base</span>.option</span>;</span></code></li><li id="type-t.backend_info" class="def record field anchored"><a href="#type-t.backend_info" class="anchor"></a><code><span><span class="keyword">mutable</span> backend_info : <span class="xref-unresolved">Base</span>.Sexp.t;</span></code></li><li id="type-t.code_name" class="def record field anchored"><a href="#type-t.code_name" class="anchor"></a><code><span><span class="keyword">mutable</span> code_name : <span><span class="xref-unresolved">Base</span>.string <span class="xref-unresolved">Base</span>.option</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_t : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span><span class="keyword">val</span> compare : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-num_elems"><a href="#val-num_elems" class="anchor"></a><code><span><span class="keyword">val</span> num_elems : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-size_in_bytes"><a href="#val-size_in_bytes" class="anchor"></a><code><span><span class="keyword">val</span> size_in_bytes : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base__Int</span>.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-id"><a href="#val-id" class="anchor"></a><code><span><span class="keyword">val</span> id : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.String.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-label"><a href="#val-label" class="anchor"></a><code><span><span class="keyword">val</span> label : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.String.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_alphanum_"><a href="#val-is_alphanum_" class="anchor"></a><code><span><span class="keyword">val</span> is_alphanum_ : <span><span class="xref-unresolved">Base</span>.String.t <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_debug_name"><a href="#val-get_debug_name" class="anchor"></a><code><span><span class="keyword">val</span> get_debug_name : 
  <span><span class="optlabel">?code_name</span>:<span class="xref-unresolved">Base</span>.String.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">id</span>:<span class="xref-unresolved">Base__Int</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">label</span>:<span><span class="xref-unresolved">Base</span>.String.t <span class="xref-unresolved">Base</span>.List.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base</span>.String.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-debug_name"><a href="#val-debug_name" class="anchor"></a><code><span><span class="keyword">val</span> debug_name : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.String.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-debug_memory_mode"><a href="#val-debug_memory_mode" class="anchor"></a><code><span><span class="keyword">val</span> debug_memory_mode : <span><span><span>(<a href="#type-memory_mode">memory_mode</a> * <span class="xref-unresolved">Base</span>.Int.t)</span> option</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.String.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-log_debug_info"><a href="#val-log_debug_info" class="anchor"></a><code><span><span class="keyword">val</span> log_debug_info : <span><span class="label">from_log_level</span>:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_to_most_local"><a href="#val-default_to_most_local" class="anchor"></a><code><span><span class="keyword">val</span> default_to_most_local : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>The one exception to &quot;most local&quot; is that the sharing property is kept at <code>Unset</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_virtual_force"><a href="#val-is_virtual_force" class="anchor"></a><code><span><span class="keyword">val</span> is_virtual_force : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_hosted_force"><a href="#val-is_hosted_force" class="anchor"></a><code><span><span class="keyword">val</span> is_hosted_force : <span><span class="optlabel">?specifically</span>:<a href="#type-memory_type">memory_type</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_materialized_force"><a href="#val-is_materialized_force" class="anchor"></a><code><span><span class="keyword">val</span> is_materialized_force : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_in_context"><a href="#val-is_in_context" class="anchor"></a><code><span><span class="keyword">val</span> is_in_context : <span><span class="label">use_host_memory</span>:<span class="xref-unresolved">Base</span>.bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>bool option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-known_shared_with_host"><a href="#val-known_shared_with_host" class="anchor"></a><code><span><span class="keyword">val</span> known_shared_with_host : <span><span class="label">use_host_memory</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>The opposite of <code>is_in_context</code> for hosted tensor nodes. False if <code>use_host_memory = false</code> or for non-hosted tensor nodes.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-known_not_materialized"><a href="#val-known_not_materialized" class="anchor"></a><code><span><span class="keyword">val</span> known_not_materialized : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-known_constant"><a href="#val-known_constant" class="anchor"></a><code><span><span class="keyword">val</span> known_constant : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-known_volatile"><a href="#val-known_volatile" class="anchor"></a><code><span><span class="keyword">val</span> known_volatile : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-known_non_virtual"><a href="#val-known_non_virtual" class="anchor"></a><code><span><span class="keyword">val</span> known_non_virtual : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-known_not_param"><a href="#val-known_not_param" class="anchor"></a><code><span><span class="keyword">val</span> known_not_param : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-known_shared_cross_stream"><a href="#val-known_shared_cross_stream" class="anchor"></a><code><span><span class="keyword">val</span> known_shared_cross_stream : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-known_non_cross_stream"><a href="#val-known_non_cross_stream" class="anchor"></a><code><span><span class="keyword">val</span> known_non_cross_stream : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-potentially_cross_stream"><a href="#val-potentially_cross_stream" class="anchor"></a><code><span><span class="keyword">val</span> potentially_cross_stream : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mode_is_unspecified"><a href="#val-mode_is_unspecified" class="anchor"></a><code><span><span class="keyword">val</span> mode_is_unspecified : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_memory_mode"><a href="#val-update_memory_mode" class="anchor"></a><code><span><span class="keyword">val</span> update_memory_mode : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-memory_mode">memory_mode</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_memory_sharing"><a href="#val-update_memory_sharing" class="anchor"></a><code><span><span class="keyword">val</span> update_memory_sharing : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-sharing">sharing</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>update_memory_sharing tn sharing provenance</code> preserves the memory mode of <code>tn</code> while updating the cross-stream sharing property, except that <code>Hosted Nonconstant</code> is further specialized to <code>Hosted (Changed_on_devices sharing)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_prec"><a href="#val-update_prec" class="anchor"></a><code><span><span class="keyword">val</span> update_prec : <span><span class="optlabel">?only_if</span>:<span>(<span><a href="../Ops/index.html#type-prec">Ops.prec</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Ops/index.html#type-prec">Ops.prec</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-exceeds_fp16_cutoff"><a href="#val-exceeds_fp16_cutoff" class="anchor"></a><code><span><span class="keyword">val</span> exceeds_fp16_cutoff : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.Float.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></summary><div class="odoc-spec"><div class="spec type anchored" id="type-comparator_witness"><a href="#type-comparator_witness" class="anchor"></a><code><span><span class="keyword">type</span> comparator_witness</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-comparator"><a href="#val-comparator" class="anchor"></a><code><span><span class="keyword">val</span> comparator : <span><span>(<a href="#type-t">t</a>, <a href="#type-comparator_witness">comparator_witness</a>)</span> <span class="xref-unresolved">Base__Comparator</span>.comparator</span></span></code></div></div></details></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hash"><a href="#val-hash" class="anchor"></a><code><span><span class="keyword">val</span> hash : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base__Ppx_hash_lib</span>.Std.Hash.hash_value</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hash_fold_t"><a href="#val-hash_fold_t" class="anchor"></a><code><span><span class="keyword">val</span> hash_fold_t : 
  <span><span class="xref-unresolved">Base__</span>.Ppx_hash_lib.Std.Hash.state <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base__</span>.Ppx_hash_lib.Std.Hash.state</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hash_t"><a href="#val-hash_t" class="anchor"></a><code><span><span class="keyword">val</span> hash_t : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base__Ppx_hash_lib</span>.Std.Hash.hash_value</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_exn"><a href="#val-get_exn" class="anchor"></a><code><span><span class="keyword">val</span> get_exn : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Ndarray/index.html#type-t">Nd.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-has"><a href="#val-has" class="anchor"></a><code><span><span class="keyword">val</span> has : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-dims_to_string"><a href="#val-dims_to_string" class="anchor"></a><code><span><span class="keyword">val</span> dims_to_string : <span><span class="optlabel">?with_axis_numbers</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.String.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-no_grad_ident_label"><a href="#val-no_grad_ident_label" class="anchor"></a><code><span><span class="keyword">val</span> no_grad_ident_label : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool * <span><span class="xref-unresolved">Base</span>.String.t option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-styled_ident"><a href="#val-styled_ident" class="anchor"></a><code><span><span class="keyword">val</span> styled_ident : 
  <span><span class="label">repeating_nograd_idents</span>:<span><span>(<span class="xref-unresolved">Base</span>.String.t, <span class="type-var">'a</span>)</span> <span class="xref-unresolved">Base</span>.Hashtbl.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">repeating_grad_idents</span>:<span><span>(<span class="xref-unresolved">Base</span>.String.t, <span class="type-var">'a</span>)</span> <span class="xref-unresolved">Base</span>.Hashtbl.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[&lt; <span>`Heuristic_ocannl of <span>[&lt; `Dot_grad <span>| `Under_grad</span> ]</span></span>
  <span>| `Name_and_label</span>
  <span>| `Name_only</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base</span>.String.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_code_name"><a href="#val-update_code_name" class="anchor"></a><code><span><span class="keyword">val</span> update_code_name : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_style"><a href="#val-get_style" class="anchor"></a><code><span><span class="keyword">val</span> get_style : 
  <span><span class="optlabel">?arg_name</span>:<span class="xref-unresolved">Base</span>.string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?no_dots</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span>[&gt; <span>`Heuristic_ocannl of <span>[&gt; `Dot_grad <span>| `Under_grad</span> ]</span></span>
  <span>| `Name_and_label</span>
  <span>| `Name_only</span> ]</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-header"><a href="#val-header" class="anchor"></a><code><span><span class="keyword">val</span> header : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Registry"><a href="#module-Registry" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Registry/index.html">Registry</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-registry"><a href="#val-registry" class="anchor"></a><code><span><span class="keyword">val</span> registry : <a href="Registry/index.html#type-t">Registry.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span><span class="optlabel">?default_prec</span>:<span><a href="../Ops/index.html#type-prec">Ops.prec</a> <a href="../Utils/Lazy/index.html#type-t">Lazy.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">id</span>:<span class="xref-unresolved">Base__Int</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">label</span>:<span><span class="xref-unresolved">Base</span>.String.t <span class="xref-unresolved">Base</span>.List.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dims</span>:<span><span><span class="xref-unresolved">Base__Int</span>.t <span class="xref-unresolved">Base</span>.Array.t</span> <a href="../Utils/Lazy/index.html#type-t">Lazy.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Ops/index.html#type-init_op">Ops.init_op</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find"><a href="#val-find" class="anchor"></a><code><span><span class="keyword">val</span> find : <span><span class="label">id</span>:<span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> <span><a href="Registry/index.html#type-data">Registry.data</a> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-print_accessible_headers"><a href="#val-print_accessible_headers" class="anchor"></a><code><span><span class="keyword">val</span> print_accessible_headers : <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-log_accessible_headers"><a href="#val-log_accessible_headers" class="anchor"></a><code><span><span class="keyword">val</span> log_accessible_headers : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></div></body></html>
