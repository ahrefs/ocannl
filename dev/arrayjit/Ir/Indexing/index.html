<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Indexing (arrayjit.Ir.Indexing)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">arrayjit</a> &#x00BB; <a href="../index.html">Ir</a> &#x00BB; Indexing</nav><header class="odoc-preamble"><h1>Module <code><span>Ir.Indexing</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-symbol"><a href="#type-symbol" class="anchor"></a><code><span><span class="keyword">type</span> symbol</span><span> = </span></code><ol><li id="type-symbol.Symbol" class="def variant constructor anchored"><a href="#type-symbol.Symbol" class="anchor"></a><code><span>| </span><span><span class="constructor">Symbol</span> <span class="keyword">of</span> <span class="xref-unresolved">Base</span>.int</span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare_symbol"><a href="#val-compare_symbol" class="anchor"></a><code><span><span class="keyword">val</span> compare_symbol : <span><a href="#type-symbol">symbol</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-symbol">symbol</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_symbol"><a href="#val-equal_symbol" class="anchor"></a><code><span><span class="keyword">val</span> equal_symbol : <span><a href="#type-symbol">symbol</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-symbol">symbol</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-symbol_of_sexp"><a href="#val-symbol_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> symbol_of_sexp : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-symbol">symbol</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_symbol"><a href="#val-sexp_of_symbol" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_symbol : <span><a href="#type-symbol">symbol</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hash_fold_symbol"><a href="#val-hash_fold_symbol" class="anchor"></a><code><span><span class="keyword">val</span> hash_fold_symbol : 
  <span><span class="xref-unresolved">Ppx_hash_lib</span>.Std.Hash.state <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-symbol">symbol</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Ppx_hash_lib</span>.Std.Hash.state</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hash_symbol"><a href="#val-hash_symbol" class="anchor"></a><code><span><span class="keyword">val</span> hash_symbol : <span><a href="#type-symbol">symbol</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_hash_lib</span>.Std.Hash.hash_value</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-symbol"><a href="#val-symbol" class="anchor"></a><code><span><span class="keyword">val</span> symbol : <span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> <a href="#type-symbol">symbol</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_symbol"><a href="#val-is_symbol" class="anchor"></a><code><span><span class="keyword">val</span> is_symbol : <span><a href="#type-symbol">symbol</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-symbol_val"><a href="#val-symbol_val" class="anchor"></a><code><span><span class="keyword">val</span> symbol_val : <span><a href="#type-symbol">symbol</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Stdlib</span>.Option.t</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Variants_of_symbol"><a href="#module-Variants_of_symbol" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Variants_of_symbol/index.html">Variants_of_symbol</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unique_id"><a href="#val-unique_id" class="anchor"></a><code><span><span class="keyword">val</span> unique_id : <span>int <span class="xref-unresolved">Base</span>.ref</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_symbol"><a href="#val-get_symbol" class="anchor"></a><code><span><span class="keyword">val</span> get_symbol : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-symbol">symbol</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-CompareSymbol"><a href="#module-CompareSymbol" class="anchor"></a><code><span><span class="keyword">module</span> <a href="CompareSymbol/index.html">CompareSymbol</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Symbol"><a href="#module-Symbol" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Symbol/index.html">Symbol</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-symbol_ident"><a href="#val-symbol_ident" class="anchor"></a><code><span><span class="keyword">val</span> symbol_ident : <span><a href="#type-symbol">symbol</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.String.t</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-environment"><a href="#type-environment" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a environment</span></span><span> = <span><span class="type-var">'a</span> <span class="xref-unresolved">Base</span>.Map.M(<span class="xref-unresolved">Symbol</span>).t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-environment_of_sexp"><a href="#val-environment_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> environment_of_sexp : 
  'a. <span><span>(<span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-environment">environment</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_environment"><a href="#val-sexp_of_environment" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_environment : 
  'a. <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-environment">environment</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-empty_env"><a href="#val-empty_env" class="anchor"></a><code><span><span class="keyword">val</span> empty_env : <span><span class="type-var">'a</span> <a href="#type-environment">environment</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-static_symbol"><a href="#type-static_symbol" class="anchor"></a><code><span><span class="keyword">type</span> static_symbol</span><span> = </span><span>{</span></code><ol><li id="type-static_symbol.static_symbol" class="def record field anchored"><a href="#type-static_symbol.static_symbol" class="anchor"></a><code><span>static_symbol : <a href="#type-symbol">symbol</a>;</span></code></li><li id="type-static_symbol.static_range" class="def record field anchored"><a href="#type-static_symbol.static_range" class="anchor"></a><code><span><span class="keyword">mutable</span> static_range : <span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.option</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare_static_symbol"><a href="#val-compare_static_symbol" class="anchor"></a><code><span><span class="keyword">val</span> compare_static_symbol : <span><a href="#type-static_symbol">static_symbol</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-static_symbol">static_symbol</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_static_symbol"><a href="#val-equal_static_symbol" class="anchor"></a><code><span><span class="keyword">val</span> equal_static_symbol : <span><a href="#type-static_symbol">static_symbol</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-static_symbol">static_symbol</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-static_symbol_of_sexp"><a href="#val-static_symbol_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> static_symbol_of_sexp : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-static_symbol">static_symbol</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_static_symbol"><a href="#val-sexp_of_static_symbol" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_static_symbol : <span><a href="#type-static_symbol">static_symbol</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hash_fold_static_symbol"><a href="#val-hash_fold_static_symbol" class="anchor"></a><code><span><span class="keyword">val</span> hash_fold_static_symbol : 
  <span><span class="xref-unresolved">Ppx_hash_lib</span>.Std.Hash.state <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-static_symbol">static_symbol</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Ppx_hash_lib</span>.Std.Hash.state</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hash_static_symbol"><a href="#val-hash_static_symbol" class="anchor"></a><code><span><span class="keyword">val</span> hash_static_symbol : <span><a href="#type-static_symbol">static_symbol</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_hash_lib</span>.Std.Hash.hash_value</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-bindings"><a href="#type-bindings" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a bindings</span></span><span> = </span></code><ol><li id="type-bindings.Empty" class="def variant constructor anchored"><a href="#type-bindings.Empty" class="anchor"></a><code><span>| </span><span><span class="constructor">Empty</span></span></code></li><li id="type-bindings.Bind" class="def variant constructor anchored"><a href="#type-bindings.Bind" class="anchor"></a><code><span>| </span><span><span class="constructor">Bind</span> <span class="keyword">of</span> <a href="#type-static_symbol">static_symbol</a> * <span><span>(<span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <a href="#type-bindings">bindings</a></span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_bindings"><a href="#val-sexp_of_bindings" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_bindings : 
  'a. <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="#type-bindings">bindings</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bound_symbols"><a href="#val-bound_symbols" class="anchor"></a><code><span><span class="keyword">val</span> bound_symbols : <span><span><span class="type-var">'a</span> <a href="#type-bindings">bindings</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-static_symbol">static_symbol</a> <span class="xref-unresolved">Base</span>.List.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-variadic"><a href="#type-variadic" class="anchor"></a><code><span><span class="keyword">type</span> <span>('r, 'idcs, 'p1, 'p2) variadic</span></span><span> = </span></code><ol><li id="type-variadic.Result" class="def variant constructor anchored"><a href="#type-variadic.Result" class="anchor"></a><code><span>| </span><span><span class="constructor">Result</span> <span class="keyword">of</span> <span class="type-var">'r</span></span></code></li><li id="type-variadic.Param_idx" class="def variant constructor anchored"><a href="#type-variadic.Param_idx" class="anchor"></a><code><span>| </span><span><span class="constructor">Param_idx</span> <span class="keyword">of</span> <span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.ref</span>
  * <span><span>(<span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'r</span>, <span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'idcs</span>, <span class="type-var">'p1</span>, <span class="type-var">'p2</span>)</span> <a href="#type-variadic">variadic</a></span></span></code></li><li id="type-variadic.Param_1" class="def variant constructor anchored"><a href="#type-variadic.Param_1" class="anchor"></a><code><span>| </span><span><span class="constructor">Param_1</span> <span class="keyword">of</span> <span><span><span class="type-var">'p1</span> <span class="xref-unresolved">Base</span>.option</span> <span class="xref-unresolved">Base</span>.ref</span> * <span><span>(<span><span class="type-var">'p1</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'r</span>, <span class="type-var">'idcs</span>, <span class="type-var">'p1</span>, <span class="type-var">'p2</span>)</span> <a href="#type-variadic">variadic</a></span></span></code></li><li id="type-variadic.Param_2" class="def variant constructor anchored"><a href="#type-variadic.Param_2" class="anchor"></a><code><span>| </span><span><span class="constructor">Param_2</span> <span class="keyword">of</span> <span><span><span class="type-var">'p2</span> <span class="xref-unresolved">Base</span>.option</span> <span class="xref-unresolved">Base</span>.ref</span> * <span><span>(<span><span class="type-var">'p2</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'r</span>, <span class="type-var">'idcs</span>, <span class="type-var">'p1</span>, <span class="type-var">'p2</span>)</span> <a href="#type-variadic">variadic</a></span></span></code></li><li id="type-variadic.Param_2f" class="def variant constructor anchored"><a href="#type-variadic.Param_2f" class="anchor"></a><code><span>| </span><span><span class="constructor">Param_2f</span> : <span>(<span><span class="type-var">'p2f</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'p2</span>)</span>
  * <span><span><span class="type-var">'p2f</span> <span class="xref-unresolved">Base</span>.option</span> <span class="xref-unresolved">Base</span>.ref</span>
  * <span><span>(<span><span class="type-var">'p2</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'r</span>, <span class="type-var">'idcs</span>, <span class="type-var">'p1</span>, <span class="type-var">'p2</span>)</span> <a href="#type-variadic">variadic</a></span> <span class="arrow">&#45;&gt;</span> <span><span>(<span class="type-var">'r</span>, <span class="type-var">'idcs</span>, <span class="type-var">'p1</span>, <span class="type-var">'p2</span>)</span> <a href="#type-variadic">variadic</a></span></span></code></li></ol></div><div class="spec-doc"><p>Helps lowering the bindings.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-unit_bindings"><a href="#type-unit_bindings" class="anchor"></a><code><span><span class="keyword">type</span> unit_bindings</span><span> = <span><span>(<span><span class="xref-unresolved">Base</span>.unit <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.unit)</span> <a href="#type-bindings">bindings</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_unit_bindings"><a href="#val-sexp_of_unit_bindings" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_unit_bindings : <span><a href="#type-unit_bindings">unit_bindings</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-lowered_bindings"><a href="#type-lowered_bindings" class="anchor"></a><code><span><span class="keyword">type</span> lowered_bindings</span><span> = <span><span>(<a href="#type-static_symbol">static_symbol</a>, <span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.ref</span>)</span> <span class="xref-unresolved">Base</span>.List.Assoc.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_lowered_bindings"><a href="#val-sexp_of_lowered_bindings" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_lowered_bindings : <span><a href="#type-lowered_bindings">lowered_bindings</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply"><a href="#val-apply" class="anchor"></a><code><span><span class="keyword">val</span> apply : 'r 'idcs 'p1 'p2. <span><span><span>(<span class="type-var">'r</span>, <span class="type-var">'idcs</span>, <span class="type-var">'p1</span>, <span class="type-var">'p2</span>)</span> <a href="#type-variadic">variadic</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'r</span></span></code></div><div class="spec-doc"><p><code>apply run_variadic ()</code> applies the parameters in reverse order to how they appear in the <code>run_variadic</code> list.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-lowered_bindings"><a href="#val-lowered_bindings" class="anchor"></a><code><span><span class="keyword">val</span> lowered_bindings : 
  <span><span><span class="type-var">'a</span> <a href="#type-bindings">bindings</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'b</span>, <span class="type-var">'a</span>, <span class="type-var">'p1</span>, <span class="type-var">'p2</span>)</span> <a href="#type-variadic">variadic</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="#type-static_symbol">static_symbol</a> * <span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.ref</span>)</span> <span class="xref-unresolved">Base</span>.List.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_exn"><a href="#val-find_exn" class="anchor"></a><code><span><span class="keyword">val</span> find_exn : <span><a href="#type-lowered_bindings">lowered_bindings</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-static_symbol">static_symbol</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.ref</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_static_symbol"><a href="#val-get_static_symbol" class="anchor"></a><code><span><span class="keyword">val</span> get_static_symbol : 
  <span><span class="optlabel">?static_range</span>:<span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span><span class="xref-unresolved">Base</span>.int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <a href="#type-bindings">bindings</a></span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-static_symbol">static_symbol</a> * <span><span class="type-var">'a</span> <a href="#type-bindings">bindings</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-dims_to_string"><a href="#val-dims_to_string" class="anchor"></a><code><span><span class="keyword">val</span> dims_to_string : 
  <span><span class="optlabel">?with_axis_numbers</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="xref-unresolved">Base</span>.Int.t <span class="xref-unresolved">Base</span>.Array.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base</span>.String.t</span></code></div><div class="spec-doc"><p>Dimensions to string, <code>&quot;x&quot;</code>-separated, e.g. 1x2x3 for batch dims 1, input dims 3, output dims 2. Outputs <code>&quot;-&quot;</code> for empty dimensions.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-axis_index"><a href="#type-axis_index" class="anchor"></a><code><span><span class="keyword">type</span> axis_index</span><span> = </span></code><ol><li id="type-axis_index.Fixed_idx" class="def variant constructor anchored"><a href="#type-axis_index.Fixed_idx" class="anchor"></a><code><span>| </span><span><span class="constructor">Fixed_idx</span> <span class="keyword">of</span> <span class="xref-unresolved">Base</span>.int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A fixed position along an axis</p><span class="comment-delim">*)</span></div></li><li id="type-axis_index.Iterator" class="def variant constructor anchored"><a href="#type-axis_index.Iterator" class="anchor"></a><code><span>| </span><span><span class="constructor">Iterator</span> <span class="keyword">of</span> <a href="#type-symbol">symbol</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A simple iterator symbol</p><span class="comment-delim">*)</span></div></li><li id="type-axis_index.Affine" class="def variant constructor anchored"><a href="#type-axis_index.Affine" class="anchor"></a><code><span>| </span><span><span class="constructor">Affine</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-axis_index.symbols" class="def record field anchored"><a href="#type-axis_index.symbols" class="anchor"></a><code><span>symbols : <span><span>(<span class="xref-unresolved">Base</span>.int * <a href="#type-symbol">symbol</a>)</span> <span class="xref-unresolved">Base</span>.list</span>;</span></code></li><li id="type-axis_index.offset" class="def record field anchored"><a href="#type-axis_index.offset" class="anchor"></a><code><span>offset : <span class="xref-unresolved">Base</span>.int;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>An affine combination of symbols with coefficients and an offset. Represents:</p><p>Σ(coeff_i * symbol_i) + offset</p><p>For convolutions: <code>symbols = [(stride, i1); (dilation, i2)]</code> and <code>offset = ~-padding</code>. Note: for readability, we use <code>Fixed_idx</code> and <code>Iterator</code> as separate variants and require <code>Affine</code> to not be ambiguous: <code>symbols</code> should be longer than 1 or have a coefficient different from 1 and 0.</p><span class="comment-delim">*)</span></div></li><li id="type-axis_index.Sub_axis" class="def variant constructor anchored"><a href="#type-axis_index.Sub_axis" class="anchor"></a><code><span>| </span><span><span class="constructor">Sub_axis</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>This axis belongs to an adjacent multi-axis index.</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare_axis_index"><a href="#val-compare_axis_index" class="anchor"></a><code><span><span class="keyword">val</span> compare_axis_index : <span><a href="#type-axis_index">axis_index</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-axis_index">axis_index</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_axis_index"><a href="#val-equal_axis_index" class="anchor"></a><code><span><span class="keyword">val</span> equal_axis_index : <span><a href="#type-axis_index">axis_index</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-axis_index">axis_index</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-axis_index_of_sexp"><a href="#val-axis_index_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> axis_index_of_sexp : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-axis_index">axis_index</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_axis_index"><a href="#val-sexp_of_axis_index" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_axis_index : <span><a href="#type-axis_index">axis_index</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-str_osym_map"><a href="#type-str_osym_map" class="anchor"></a><code><span><span class="keyword">type</span> str_osym_map</span><span> =
  <span><span>(<span class="xref-unresolved">Base</span>.string, <span><a href="#type-symbol">symbol</a> <span class="xref-unresolved">Base</span>.option</span>, <span class="xref-unresolved">Base</span>.String.comparator_witness)</span> <span class="xref-unresolved">Base</span>.Map.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_str_osym_map"><a href="#val-sexp_of_str_osym_map" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_str_osym_map : <span><a href="#type-str_osym_map">str_osym_map</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-projections_debug"><a href="#type-projections_debug" class="anchor"></a><code><span><span class="keyword">type</span> projections_debug</span><span> = </span><span>{</span></code><ol><li id="type-projections_debug.spec" class="def record field anchored"><a href="#type-projections_debug.spec" class="anchor"></a><code><span>spec : <span class="xref-unresolved">Base</span>.string;</span></code></li><li id="type-projections_debug.derived_for" class="def record field anchored"><a href="#type-projections_debug.derived_for" class="anchor"></a><code><span>derived_for : <span class="xref-unresolved">Base</span>.Sexp.t;</span></code></li><li id="type-projections_debug.trace" class="def record field anchored"><a href="#type-projections_debug.trace" class="anchor"></a><code><span>trace : <span><span>(<span class="xref-unresolved">Base</span>.string * <span class="xref-unresolved">Base</span>.int)</span> <span class="xref-unresolved">Base</span>.list</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-projections_debug_of_sexp"><a href="#val-projections_debug_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> projections_debug_of_sexp : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-projections_debug">projections_debug</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_projections_debug"><a href="#val-sexp_of_projections_debug" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_projections_debug : <span><a href="#type-projections_debug">projections_debug</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unique_debug_id"><a href="#val-unique_debug_id" class="anchor"></a><code><span><span class="keyword">val</span> unique_debug_id : <span>unit <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-projections"><a href="#type-projections" class="anchor"></a><code><span><span class="keyword">type</span> projections</span><span> = </span><span>{</span></code><ol><li id="type-projections.product_space" class="def record field anchored"><a href="#type-projections.product_space" class="anchor"></a><code><span>product_space : <span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.array</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The product space dimensions that an operation should parallelize (map-reduce) over.</p><span class="comment-delim">*)</span></div></li><li id="type-projections.lhs_dims" class="def record field anchored"><a href="#type-projections.lhs_dims" class="anchor"></a><code><span>lhs_dims : <span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.array</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The dimensions of the LHS array.</p><span class="comment-delim">*)</span></div></li><li id="type-projections.rhs_dims" class="def record field anchored"><a href="#type-projections.rhs_dims" class="anchor"></a><code><span>rhs_dims : <span><span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.array</span> <span class="xref-unresolved">Base</span>.array</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The dimensions of the RHS arrays, needed for deriving projections from other projections.</p><span class="comment-delim">*)</span></div></li><li id="type-projections.product_iterators" class="def record field anchored"><a href="#type-projections.product_iterators" class="anchor"></a><code><span>product_iterators : <span><a href="#type-symbol">symbol</a> <span class="xref-unresolved">Base</span>.array</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The product space iterators (concatentation of the relevant batch, output, input axes) for iterating over the <code>product_space</code> axes, where same axes are at same array indices. These may be shared; lowering creates fresh symbols for loop indices.</p><span class="comment-delim">*)</span></div></li><li id="type-projections.project_lhs" class="def record field anchored"><a href="#type-projections.project_lhs" class="anchor"></a><code><span>project_lhs : <span><a href="#type-axis_index">axis_index</a> <span class="xref-unresolved">Base</span>.array</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A projection that takes an <code>product_space</code>-bound index and produces an index into the result of an operation.</p><span class="comment-delim">*)</span></div></li><li id="type-projections.project_rhs" class="def record field anchored"><a href="#type-projections.project_rhs" class="anchor"></a><code><span>project_rhs : <span><span><a href="#type-axis_index">axis_index</a> <span class="xref-unresolved">Base</span>.array</span> <span class="xref-unresolved">Base</span>.array</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>project_rhs.(i)</code> Produces an index into the <code>i+1</code>th argument of an operation.</p><span class="comment-delim">*)</span></div></li><li id="type-projections.debug_info" class="def record field anchored"><a href="#type-projections.debug_info" class="anchor"></a><code><span>debug_info : <a href="#type-projections_debug">projections_debug</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>All the information relevant for code generation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare_projections"><a href="#val-compare_projections" class="anchor"></a><code><span><span class="keyword">val</span> compare_projections : <span><a href="#type-projections">projections</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-projections">projections</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_projections"><a href="#val-equal_projections" class="anchor"></a><code><span><span class="keyword">val</span> equal_projections : <span><a href="#type-projections">projections</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-projections">projections</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-projections_of_sexp"><a href="#val-projections_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> projections_of_sexp : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-projections">projections</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_projections"><a href="#val-sexp_of_projections" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_projections : <span><a href="#type-projections">projections</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-iterated"><a href="#val-iterated" class="anchor"></a><code><span><span class="keyword">val</span> iterated : <span>int <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-opt_symbol"><a href="#val-opt_symbol" class="anchor"></a><code><span><span class="keyword">val</span> opt_symbol : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-symbol">symbol</a> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-opt_iterator"><a href="#val-opt_iterator" class="anchor"></a><code><span><span class="keyword">val</span> opt_iterator : <span><span><a href="#type-symbol">symbol</a> option</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-axis_index">axis_index</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_surjective"><a href="#val-is_surjective" class="anchor"></a><code><span><span class="keyword">val</span> is_surjective : <span><a href="#type-projections">projections</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_injective"><a href="#val-is_injective" class="anchor"></a><code><span><span class="keyword">val</span> is_injective : <span><a href="#type-projections">projections</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-identity_projections"><a href="#val-identity_projections" class="anchor"></a><code><span><span class="keyword">val</span> identity_projections : 
  <span><span class="optlabel">?debug_info</span>:<a href="#type-projections_debug">projections_debug</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?derived_for</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">lhs_dims</span>:<span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.Array.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-projections">projections</a></span></code></div><div class="spec-doc"><p>Projections for a pointwise unary operator. Provide only one of <code>debug_info</code> or <code>derived_for</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-reflect_projection"><a href="#val-reflect_projection" class="anchor"></a><code><span><span class="keyword">val</span> reflect_projection : 
  <span><span class="label">dims</span>:<span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">projection</span>:<span><a href="#type-axis_index">axis_index</a> <span class="xref-unresolved">Base</span>.array</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-axis_index">axis_index</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-variable_ref"><a href="#type-variable_ref" class="anchor"></a><code><span><span class="keyword">type</span> variable_ref</span><span> = </span><span>{</span></code><ol><li id="type-variable_ref.ref_label" class="def record field anchored"><a href="#type-variable_ref.ref_label" class="anchor"></a><code><span>ref_label : <span class="xref-unresolved">Base</span>.string;</span></code></li><li id="type-variable_ref.solved_dim" class="def record field anchored"><a href="#type-variable_ref.solved_dim" class="anchor"></a><code><span><span class="keyword">mutable</span> solved_dim : <span><span class="xref-unresolved">Base</span>.int <span class="xref-unresolved">Base</span>.option</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_variable_ref"><a href="#val-sexp_of_variable_ref" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_variable_ref : <span><a href="#type-variable_ref">variable_ref</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal_variable_ref"><a href="#val-equal_variable_ref" class="anchor"></a><code><span><span class="keyword">val</span> equal_variable_ref : <span><a href="#type-variable_ref">variable_ref</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-variable_ref">variable_ref</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.bool</span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Doc_helpers"><a href="#module-Doc_helpers" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Doc_helpers/index.html">Doc_helpers</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>
